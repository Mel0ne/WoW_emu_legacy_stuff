From 63b73a9b8516d4c0a843e82c9e5e79b76d512ada Mon Sep 17 00:00:00 2001
From: Eilo <eilo2518@gmail.com>
Date: Tue, 3 Jan 2012 14:48:23 -0500
Subject: [PATCH 58/65] =?UTF-8?q?2.16.1=20HallsOfReflection:=20Reimplementac?=
 =?UTF-8?q?ion,=20flags=20y=20a=C3=B1adido=20segunda=20fase?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 .../2011_10_08_100_world_halls_of_reflection.sql   |  363 +++++++
 src/server/game/Scripting/ScriptLoader.cpp         |    2 +
 src/server/scripts/Northrend/CMakeLists.txt        |    1 +
 .../HallsOfReflection/boss_the_lich_king_hor.cpp   |  682 ++++++++++++
 .../HallsOfReflection/halls_of_reflection.cpp      | 1110 +++++++++++++++++++-
 .../HallsOfReflection/halls_of_reflection.h        |   95 ++-
 .../instance_halls_of_reflection.cpp               |  296 +++++-
 7 files changed, 2463 insertions(+), 86 deletions(-)
 create mode 100644 sql/updates/world/reanemu/2011_10_08_100_world_halls_of_reflection.sql
 create mode 100644 src/server/scripts/Northrend/FrozenHalls/HallsOfReflection/boss_the_lich_king_hor.cpp

diff --git a/sql/updates/world/reanemu/2011_10_08_100_world_halls_of_reflection.sql b/sql/updates/world/reanemu/2011_10_08_100_world_halls_of_reflection.sql
new file mode 100644
index 0000000..bc06c4b
--- /dev/null
+++ b/sql/updates/world/reanemu/2011_10_08_100_world_halls_of_reflection.sql
@@ -0,0 +1,363 @@
+-- Eilo (https://github.com/eilo)
+-- Recopilacion y adecuacion de querys originales de HyD y varios autores de scripts antiguas y raras
+-- Algunas querys anadidas y ordenacion/comentarios del sql por Eilo
+
+-- INSTANCE: Halls of Reflection
+-- Creature Templates
+SET @NPC_JAINA_OUTRO        := 36955;
+SET @NPC_SYLVANA_OUTRO      := 37554;
+SET @NPC_LICH_KING_BOSS     := 37226;
+
+-- Unit flags de HoR (por Eilo)
+UPDATE `creature_template` SET `unit_flags`=0 WHERE `entry` IN (38112,38599,38113,38603,36954,38173,38525,38172,38524,38176,38544,38175,38563,38177,38564,36723,37720,37226,36940,37550,36941,37551,37069,37549,38567,38568);
+
+-- Complementos Intro
+UPDATE `creature_template` SET `scale`='0.8', `equipment_id`='1221' WHERE `entry` IN (37221, @NPC_JAINA_OUTRO);
+UPDATE `creature_template` SET `equipment_id`='1290' WHERE `entry` IN (37223, @NPC_SYLVANA_OUTRO);
+UPDATE `creature_template` SET `equipment_id`='0' WHERE `entry`=36954;
+UPDATE `creature_template` SET `scale`='0.8' WHERE `entry` IN (37225, 37223, @NPC_LICH_KING_BOSS, @NPC_SYLVANA_OUTRO);
+
+-- Complementos Mini boss
+UPDATE `creature_template` SET `speed_walk`='1.8', `speed_run`='2.0' WHERE `entry` IN (36954, @NPC_LICH_KING_BOSS);
+UPDATE `creature_template` SET `AIName`='', `Scriptname`='npc_frostworn_general' WHERE `entry`=36723;
+UPDATE `creature_template` SET `flags_extra` = 1 WHERE `entry` = 36723;
+UPDATE `creature_template` SET `flags_extra` = 257 WHERE `entry` = 36723;
+
+-- Complementos Segunda Parte
+UPDATE `creature_template` SET `AIName`='', `Scriptname`='npc_jaina_and_sylvana_hor_part2' WHERE `entry` IN (@NPC_JAINA_OUTRO, @NPC_SYLVANA_OUTRO);
+UPDATE `creature_template` SET `AIName`='', `Scriptname`='boss_lich_king_hor' WHERE `entry`=@NPC_LICH_KING_BOSS;
+UPDATE `creature_template` SET `AIName`='', `Scriptname`='npc_raging_gnoul' WHERE `entry`=36940;
+UPDATE `creature_template` SET `AIName`='', `Scriptname`='npc_risen_witch_doctor' WHERE `entry`=36941;
+UPDATE `creature_template` SET `AIName`='', `Scriptname`='npc_abon' WHERE `entry`=37069;
+UPDATE `creature_template` SET `AIName`='', `Scriptname`='npc_queldelar' WHERE `entry`=37158;
+
+-- Complementos adicionales
+UPDATE `creature_template` SET `unit_flags` = 32784, `AIName` = '', `ScriptName` = 'npc_spiritual_reflection', `difficulty_entry_1` = 37721 WHERE `entry` = 37107;
+UPDATE `creature_template` SET `minlevel` = 80, `maxlevel` = 80, `unit_flags` = 32784, `mindmg` = '422', `maxdmg` = '586', `attackpower` = '642', `dmg_multiplier` = '13' WHERE `entry` = 37721;
+
+-- Quitando a Uther visible
+DELETE FROM `creature` WHERE `id` IN (37225) AND `map` = 668;
+
+-- Quitando a Arthas visible
+DELETE FROM `creature` WHERE `id` IN (37226) AND `map` = 668;
+
+-- Spawn Quel'delar
+DELETE FROM `creature` WHERE `id` IN (37158) AND `map` = 668;
+INSERT INTO `creature` (`id`,`map`,`spawnMask`,`phaseMask`,`modelid`,`equipment_id`,`position_x`,`position_y`,`position_z`,`orientation`,`spawntimesecs`,`spawndist`,`currentwaypoint`,`curhealth`,`curmana`,`MovementType`,`npcflag`,`unit_flags`,`dynamicflags`)
+VALUES 
+('37158', '668', '3', '2', '0', '0', '5304.5', '2001.35', '709.341', '4.15073', '7200', '0', '0', '214200', '0', '0', '0', '0', '0');
+
+-- Spawn de Falric y Marwyn
+DELETE FROM `creature` WHERE `id` IN (38112,38599,38113,38603);
+INSERT INTO `creature` (`id`,`map`,`spawnMask`,`phaseMask`,`modelid`,`equipment_id`,`position_x`,`position_y`,`position_z`,`orientation`,`spawntimesecs`,`spawndist`,`currentwaypoint`,`curhealth`,`curmana`,`MovementType`,`npcflag`,`unit_flags`,`dynamicflags`)
+VALUES 
+('38112','668','3','1','0','0','5271.65','2042.5','709.32','5.51217','604800','0','0','377468','0','0','0','0','0'),
+('38599','668','3','1','0','0','5271.65','2042.5','709.32','5.51217','604800','0','0','377468','0','0','0','0','0'),
+('38113','668','3','1','0','0','5344.75','1972.87','709.319','2.33445','604800','0','0','539240','0','0','0','0','0'),
+('38603','668','3','1','0','0','5344.75','1972.87','709.319','2.33445','604800','0','0','539240','0','0','0','0','0');
+
+-- Spawn de Frostsworn General
+DELETE FROM `creature` WHERE `id` IN (36723);
+INSERT INTO `creature` (`id`,`map`,`spawnMask`,`phaseMask`,`modelid`,`equipment_id`,`position_x`,`position_y`,`position_z`,`orientation`,`spawntimesecs`,`spawndist`,`currentwaypoint`,`curhealth`,`curmana`,`MovementType`,`npcflag`,`unit_flags`,`dynamicflags`)
+VALUES
+('36723','668','3','1','0','2432','5413.9','2116.65','707.695','3.94765','604800','0','0','315000','0','0','0','0','0');
+
+-- Facciones gameobjects
+UPDATE `gameobject_template` SET `faction`='1375' WHERE `entry` IN (197341, 202302, 201385, 201596);
+
+-- Textos
+DELETE FROM `script_texts` WHERE `entry` BETWEEN -1594540 AND -1594430;
+INSERT INTO `script_texts` (`entry`,`content_default`,`content_loc8`,`sound`,`TYPE`,`LANGUAGE`,`emote`,`COMMENT`) VALUES
+(-1594473, 'Insensata, buscas lo que asesine tiempo atras. Ahora no es mas que un fantasma, un eco lejano en mi mente.', '', 17229,1,0,0, '67234'),
+(-1594474, 'No cometere el mismo error, Sylvanas. Esta vez no habra escapatoria. Fallaste al servirme como no muerta. Ahora lo que te queda es el olvido.', '', 17228,1,0,0, '67234'),
+-- SCENE - Hall Of Reflection (Extro) - PreEscape
+(-1594477, 'Han llegado tus aliados, Jaina, como prometiste. Todos sereis poderosos agentes de la Plaga.', '', 17212,1,0,0, '67234'),
+(-1594478, 'No cometere el mismo error, Sylvanas. Esta vez no habra escapatoria. Me servireis en la muerte!', '', 17213,1,0,0, '67234'),
+(-1594479, 'Es demasiado poderoso, debemos abandonar este lugar ahora mismo! Mi magia podra inmovilizarlo brevemente! Vamos rapido, heroes!', '', 16644,0,0,1, '67234'),
+(-1594480, 'Es demasiado poderoso! Heroes, rapido, venid! Debemos abandonar este lugar ahora mismo! Hare lo que pueda para inmovilizarlo mientras huimos.', '', 17058,0,0,1, '67234'),
+-- SCENE - Hall Of Reflection (Extro) - Escape
+(-1594481, 'El frio abrazo de la muerte os aguarda!', '', 17221,1,0,0, '67234'),
+(-1594482, 'Alzaos esbirros! Que no pasen!', '', 17216,1,0,0, '67234'),
+(-1594483, 'Esbirros cojedlos. Traedme sus cadaveres!', '', 17222,1,0,0, '67234'),
+(-1594484, 'Sin esperanza...', '!', 17214,1,0,0, '67234'),
+(-1594485, 'Todo perdido!', '', 17215,1,0,0, '67234'),
+(-1594486, 'No hay escapatoria!', '', 17217,1,0,0, '67234'),
+(-1594487, 'Destruire esta barrera. Debeis mantener atras a los no muertos!', '', 16607,1,0,0, '67234'),
+(-1594488, 'Ninguna pared detendre a la Reina Alma en Pena! Mantened a los no muertos a raya, heroes! Destruire esta barrera!', '', 17029,1,0,0, '67234'),
+(-1594489, 'Otro muro de hielo! Evitad que los no muertos interrumpan mis conjuros para que pueda derribar este muro!', '', 16608,1,0,0, '67234'),
+(-1594490, 'Otra barrera? Sed fuertes, campeones! Derrumbare el muro!', '', 17030,1,0,0, '67234'),
+(-1594491, 'Sucumbid al frio de la tumba.', '', 17218,1,0,0, '67234'),
+(-1594492, 'Otro final sin salida.', '', 17219,1,0,0, '67234'),
+(-1594493, 'Cuanto vais a aguantar?', '', 17220,1,0,0, '67234'),
+(-1594494, 'Esta jugando con nosotros. Le ense単are lo que le pasa al hielo cuando se junta con el fuego!', '', 16609,0,0,0, '67234'),
+(-1594495, 'Tus muros no pueden detenernos, monstruo. Los destruire todos!', '', 16610,1,0,0, '67234'),
+(-1594496, 'Me canso de estos juegos, Arthas! Tus muros no me detendran!', '', 17031,1,0,0, '67234'),
+(-1594497, 'No impediras que escapemos, demonio. Acabad con los no muertos mientras derribo esta barrera!', '', 17032,1,0,0, '67234'),
+(-1594498, 'Hay una salida ahi delante, vamos!', '', 16645,1,0,0, '67234'),
+(-1594499, 'Casi estamos, no os rindais!', '', 16646,1,0,0, '67234'),
+(-1594500, 'Hay una salida ahi delante, vamos!', '', 17059,1,0,0, '67234'),
+(-1594501, 'Casi estamos, no os rindais!', '', 17060,1,0,0, '67234'),
+(-1594502, 'No... No hay salida. No tenemos mas opcion que luchar. Armaos de valor heroes, pues esta sera nuestra ultima batalla!', '', 16647,1,0,0, '67234'),
+(-1594503, 'Maldicion, no hay salida! Asi es como acaba. Preparaos heroes, hoy tendra lugar nuestra ultima batalla!', '', 17061,1,0,0, '67234'),
+(-1594504, 'No corrais. Sois mios....', '', 17223,1,0,0, '67234'),
+(-1594524,'Perdonadme heroes. Debi escuchar a Uther. Tenia que verlo por mi misma, poder mirarle a los ojos una ultima vez. Lo siento.', '','16648','0','0','0','67234'),
+(-1594525,'Ahora sabemos que debemos hacer, les dare estas noticias al Rey Varian y al alto se単or Vadin.','','16649','0','0','0','67234'),
+(-1594522,'Fuego, fuego!','','16732','1','0','0','67234'),
+(-1594523,'A bordo! Ya! La ladera de la monta単a se derrumbara en cualquier momento!','','16733','1','0','0','67234'),
+(-1594521,'Estamos a salvo por ahora. Su fuerza se ha multiplicado desde nuestra ultima batalla. Necesitamos un ejercito poderoso para destruir al Rey Exanime, mejor incluso que el que la Horda puede convocar.','','17062','0','0','0','67234'),
+(-1594526,'Fuego, fuego!','','16721','1','0','0','67234'),
+(-1594527,'Rapido! A bordo! No debemos entretenernos. La ladera de la monta単a se derrumbara en cualquier momento!','','16722','1','0','0','67234'),
+(-1594505, 'Soldados de Lordaeron, alzaos ante la llamada de vuestro maestro!', '', 16714,1,0,0, '67234'),
+(-1594506, 'El maestro observo su reino, y lo encontro... incompleto. Su juicio fue rapido y despiado. Muerte a todos!', '', 16738,1,0,0, '67234'),
+-- FrostWorn General
+(-1594519, 'No sois dignos de enfrentaros al Rey Exanime!', '', 16921,1,0,0, '67234'),
+(-1594520, 'Maestro, he fracasado...', '', 16922,1,0,0, '67234');
+
+-- Waipoints
+DELETE FROM script_waypoint WHERE entry IN (@NPC_JAINA_OUTRO,@NPC_LICH_KING_BOSS,@NPC_SYLVANA_OUTRO);
+INSERT INTO script_waypoint VALUES
+-- Jaina
+
+   (@NPC_JAINA_OUTRO, 0, 5587.682,2228.586,733.011, 0, 'WP1'),
+   (@NPC_JAINA_OUTRO, 1, 5600.715,2209.058,731.618, 0, 'WP2'),
+   (@NPC_JAINA_OUTRO, 2, 5606.417,2193.029,731.129, 0, 'WP3'),
+   (@NPC_JAINA_OUTRO, 3, 5598.562,2167.806,730.918, 0, 'WP4 - Summon IceWall 01'),
+   (@NPC_JAINA_OUTRO, 4, 5556.436,2099.827,731.827, 0, 'WP5 - Spell Channel'),
+   (@NPC_JAINA_OUTRO, 5, 5543.498,2071.234,731.702, 0, 'WP6'),
+   (@NPC_JAINA_OUTRO, 6, 5528.969,2036.121,731.407, 0, 'WP7'),
+   (@NPC_JAINA_OUTRO, 7, 5512.045,1996.702,735.122, 0, 'WP8'),
+   (@NPC_JAINA_OUTRO, 8, 5504.490,1988.789,735.886, 0, 'WP9 - Spell Channel'),
+   (@NPC_JAINA_OUTRO, 9, 5489.645,1966.389,737.653, 0, 'WP10'),
+   (@NPC_JAINA_OUTRO, 10, 5475.517,1943.176,741.146, 0, 'WP11'),
+   (@NPC_JAINA_OUTRO, 11, 5466.930,1926.049,743.536, 0, 'WP12'),
+   (@NPC_JAINA_OUTRO, 12, 5445.157,1894.955,748.757, 0, 'WP13 - Spell Channel'),
+   (@NPC_JAINA_OUTRO, 13, 5425.907,1869.708,753.237, 0, 'WP14'),
+   (@NPC_JAINA_OUTRO, 14, 5405.118,1833.937,757.486, 0, 'WP15'),
+   (@NPC_JAINA_OUTRO, 15, 5370.324,1799.375,761.007, 0, 'WP16'),
+   (@NPC_JAINA_OUTRO, 16, 5335.422,1766.951,767.635, 0, 'WP17 - Spell Channel'),
+   (@NPC_JAINA_OUTRO, 17, 5311.438,1739.390,774.165, 0, 'WP18'),
+   (@NPC_JAINA_OUTRO, 18, 5283.589,1703.755,784.176, 0, 'WP19'),
+   (@NPC_JAINA_OUTRO, 19, 5260.400,1677.775,784.301, 3000, 'WP20'),
+   (@NPC_JAINA_OUTRO, 20, 5262.439,1680.410,784.294, 0, 'WP21'),
+   (@NPC_JAINA_OUTRO, 21, 5260.400,1677.775,784.301, 0, 'WP22'),
+
+-- Sylvana
+
+   (@NPC_SYLVANA_OUTRO, 0, 5587.682,2228.586,733.011, 0, 'WP1'),
+   (@NPC_SYLVANA_OUTRO, 1, 5600.715,2209.058,731.618, 0, 'WP2'),
+   (@NPC_SYLVANA_OUTRO, 2, 5606.417,2193.029,731.129, 0, 'WP3'),
+   (@NPC_SYLVANA_OUTRO, 3, 5598.562,2167.806,730.918, 0, 'WP4 - Summon IceWall 01'),
+   (@NPC_SYLVANA_OUTRO, 4, 5556.436,2099.827,731.827, 0, 'WP5 - Spell Channel'),
+   (@NPC_SYLVANA_OUTRO, 5, 5543.498,2071.234,731.702, 0, 'WP6'),
+   (@NPC_SYLVANA_OUTRO, 6, 5528.969,2036.121,731.407, 0, 'WP7'),
+   (@NPC_SYLVANA_OUTRO, 7, 5512.045,1996.702,735.122, 0, 'WP8'),
+   (@NPC_SYLVANA_OUTRO, 8, 5504.490,1988.789,735.886, 0, 'WP9 - Spell Channel'),
+   (@NPC_SYLVANA_OUTRO, 9, 5489.645,1966.389,737.653, 0, 'WP10'),
+   (@NPC_SYLVANA_OUTRO, 10, 5475.517,1943.176,741.146, 0, 'WP11'),
+   (@NPC_SYLVANA_OUTRO, 11, 5466.930,1926.049,743.536, 0, 'WP12'),
+   (@NPC_SYLVANA_OUTRO, 12, 5445.157,1894.955,748.757, 0, 'WP13 - Spell Channel'),
+   (@NPC_SYLVANA_OUTRO, 13, 5425.907,1869.708,753.237, 0, 'WP14'),
+   (@NPC_SYLVANA_OUTRO, 14, 5405.118,1833.937,757.486, 0, 'WP15'),
+   (@NPC_SYLVANA_OUTRO, 15, 5370.324,1799.375,761.007, 0, 'WP16'),
+   (@NPC_SYLVANA_OUTRO, 16, 5335.422,1766.951,767.635, 0, 'WP17 - Spell Channel'),
+   (@NPC_SYLVANA_OUTRO, 17, 5311.438,1739.390,774.165, 0, 'WP18'),
+   (@NPC_SYLVANA_OUTRO, 18, 5283.589,1703.755,784.176, 0, 'WP19'),
+   (@NPC_SYLVANA_OUTRO, 19, 5260.400,1677.775,784.301, 3000, 'WP20'),
+   (@NPC_SYLVANA_OUTRO, 20, 5262.439,1680.410,784.294, 0, 'WP21'),
+   (@NPC_SYLVANA_OUTRO, 21, 5260.400,1677.775,784.301, 0, 'WP22'),
+
+-- Lich King
+
+   (@NPC_LICH_KING_BOSS, 1, 5577.19, 2236, 733.012, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 2, 5580.57, 2232.22, 733.012, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 3, 5586.67, 2225.54, 733.012, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 4, 5590.45, 2221.41, 733.012, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 5, 5595.75, 2215.62, 732.101, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 6, 5601.21, 2206.49, 731.54, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 7, 5605.01, 2197.9, 731.667, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 8, 5606.55, 2191.39, 730.977, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 9, 5604.68, 2186.11, 730.998, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 10, 5602.26, 2179.9, 730.967, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 11, 5600.06, 2174.38, 730.924, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 12, 5597.29, 2166.81, 730.924, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 13, 5596.25, 2160.36, 730.931, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 14, 5591.79, 2152.87, 731.008, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 15, 5585.47, 2146.63, 731.109, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 16, 5579.1, 2140.34, 731.18, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 17, 5572.56, 2134.21, 731.092, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 18, 5564.08, 2126.53, 730.816, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 19, 5559.04, 2117.64, 730.812, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 20, 5555.77, 2111.88, 730.995, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 21, 5550.82, 2103.14, 731.123, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 22, 5546.02, 2094.68, 731.16, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 23, 5541.53, 2084.42, 730.999, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 24, 5537.5, 2075.18, 730.901, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 25, 5533.76, 2063.84, 730.87, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 26, 5530.97, 2052.98, 730.981, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 27, 5526.75, 2041.73, 731.193, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 28, 5522.88, 2031.65, 731.7, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 29, 5521.01, 2023.02, 732.396, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 30, 5516.55, 2015.36, 733.12, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 31, 5513.06, 2007.33, 733.99, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 32, 5510.43, 1997.9, 735.016, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 33, 5504.53, 1990.39, 735.748, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 34, 5499.34, 1983.78, 736.29, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 35, 5493.11, 1975.86, 736.852, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 36, 5487.58, 1968.81, 737.394, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 37, 5483.12, 1961.78, 738.06, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 38, 5478.33, 1954.2, 739.343, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 39, 5475.2, 1945.84, 740.697, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 40, 5472.15, 1938.02, 741.884, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 41, 5469.26, 1931.34, 742.813, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 42, 5464.23, 1922.25, 744.055, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 43, 5458.43, 1912.96, 745.229, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 44, 5452.26, 1902.95, 747.091, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 45, 5442.44, 1892.51, 749.208, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 46, 5435.67, 1879.7, 751.776, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 47, 5429.03, 1870.73, 753.151, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 48, 5423.72, 1862.16, 754.263, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 49, 5417.21, 1851.7, 755.507, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 50, 5408.94, 1838.38, 757.002, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 51, 5398.8, 1829.61, 757.742, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 52, 5388.47, 1817.95, 759.285, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 53, 5378.23, 1808.5, 760.316, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 54, 5368.5, 1801.35, 760.845, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 55, 5360.86, 1793.16, 762.271, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 56, 5353.62, 1785.4, 763.868, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 57, 5344.78, 1776.09, 765.759, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 58, 5336.38, 1768.67, 767.324, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 59, 5327.56, 1760.12, 769.332, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 60, 5319.62, 1750.7, 771.487, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 61, 5313.12, 1742.99, 773.424, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 62, 5305.41, 1735.79, 775.473, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 63, 5298.93, 1728.16, 777.573, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 64, 5292.54, 1720.37, 779.862, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 65, 5287.11, 1713.96, 781.667, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 66, 5280.14, 1705.21, 784.65, 0, 'HoR WP LichKing'),
+   (@NPC_LICH_KING_BOSS, 67, 5277.98, 1701.28, 785.224, 0, 'HoR WP LichKing');
+
+-- AreaTrigger for waves restarter
+DELETE FROM `areatrigger_scripts` WHERE `entry` = 5697;
+INSERT INTO `areatrigger_scripts` VALUES
+(5697, 'at_hor_waves_restarter');
+
+-- GameObject Templates
+DELETE FROM gameobject_template WHERE entry IN (201709, 202211, 190236, 196391, 196392, 197341, 197342, 197343, 201385, 201596, 201710, 201747, 201756, 201885, 201976, 202079, 202212, 202236, 202302, 202336, 202337, 202396, 500001, 500002, 500003);
+INSERT INTO `gameobject_template` (`entry`, `TYPE`, `displayId`, `NAME`, `IconName`, `castBarCaption`, `unk1`, `faction`, `flags`, `size`, `questItem1`, `questItem2`, `questItem3`, `questItem4`, `questItem5`, `questItem6`, `data0`, `data1`, `data2`, `data3`, `data4`, `data5`, `data6`, `data7`, `data8`, `data9`, `data10`, `data11`, `data12`, `data13`, `data14`, `data15`, `data16`, `data17`, `data18`, `data19`, `data20`, `data21`, `data22`, `data23`, `AIName`, `ScriptName`, `WDBVerified`) VALUES
+('201596','0','9223','Cave In','','','','1375','4','2','0','0','0','0','0','0','1','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('197342','0','9124','Doodad_IceCrown_Door_02','','','','1375','36','1','0','0','0','0','0','0','1','0','3','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('197343','0','9124','Doodad_IceCrown_Door_03','','','','1375','36','1','0','0','0','0','0','0','1','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('201976','0','9124','Doodad_IceCrown_Door_04','','','','114','32','1','0','0','0','0','0','0','1','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('196391','31','8196','Doodad_InstanceNewPortal_Purple01','','','','0','0','2.72','0','0','0','0','0','0','632','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('201747','31','8196','Doodad_InstanceNewPortal_Purple01','','','','0','0','2.72','0','0','0','0','0','0','668','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('196392','31','8197','Doodad_InstanceNewPortal_Purple_Skull01','','','','0','0','2.72','0','0','0','0','0','0','632','1','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('201756','31','8197','Doodad_InstanceNewPortal_Purple_Skull01','','','','0','0','2.72','0','0','0','0','0','0','668','1','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('202302','0','9301','Frostmourne','','','','1375','32','1','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('202236','0','9294','Frostmourne Altar','','','','114','32','1','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('190236','0','7876','Gate','','','','114','32','0.88','0','0','0','0','0','0','0','0','3000','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('201385','0','9214','Ice Wall','','','','1375','1','2.5','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('500001','0','9214','Ice Wall','','','','1375','1','2.5','0','0','0','0','0','0','1','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','1'),
+('201885','0','9214','Ice Wall','','','','0','1','2','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('202396','0','9214','Ice Wall','','','','114','33','2','0','0','0','0','0','0','1','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('197341','0','9124','Impenetrable Door','','','','1375','32','1','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('500003','14','8253','Orgrim\'s Hammer','','','','0','1','1','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','1'),
+('202079','22','8111','Portal to Dalaran','','','','0','0','1','0','0','0','0','0','0','53141','0','0','1','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('201710','3','9280','The Captain\'s Chest','','','','1732','0','1','0','0','0','0','0','0','57','27985','0','1','0','0','0','0','0','0','0','1','0','0','0','1','0','0','0','0','0','0','0','0','','','12340'),
+('202337','3','9281','The Captain\'s Chest','','','','1735','0','1','0','0','0','0','0','0','57','27993','0','1','0','0','0','0','0','0','0','1','0','0','0','1','0','0','0','0','0','0','0','0','','','12340'),
+('202336','3','9280','The Captain\'s Chest','','','','1732','0','1','0','0','0','0','0','0','57','27993','0','1','0','0','0','0','0','0','0','1','0','0','0','1','0','0','0','0','0','0','0','0','','','12340'),
+('202212','3','9281','The Captain\'s Chest','','','','1735','0','1','0','0','0','0','0','0','57','27985','0','1','0','0','0','0','0','0','0','1','0','0','0','1','0','0','0','0','0','0','0','0','','','11723'),
+('500002','14','9150','The Skybreaker','','','','0','1','1','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','1'),
+('201709','5','9288','Gunship Stairs','','','','0','1','2','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340'),
+('202211','5','9289','Gunship Stairs','','','','0','1','2','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','','','12340');
+
+-- Gameobject Spawns
+DELETE FROM gameobject WHERE map = 668 AND id IN (190236, 196391, 196392, 197341, 197342, 197343, 201385, 201596, 201710, 201747, 201756, 201885, 201976, 202079, 202212, 202236, 202302, 202336, 202337, 202396, 500001, 500002, 500003);
+SET @GUID_GO := 153000;
+INSERT INTO `gameobject` (`guid`, `id`, `map`, `spawnMask`, `phaseMask`, `position_x`, `position_y`, `position_z`, `orientation`, `rotation0`, `rotation1`, `rotation2`, `rotation3`, `spawntimesecs`, `animprogress`, `state`) VALUES
+(@GUID_GO,201747,668,3,1,5231.04,1923.79,707.044,0.810935,0,0,-0.370856,0.928691,6000,100,1),
+(@GUID_GO+1,201756,668,3,1,5231.04,1923.79,707.044,0.810935,0,0,-0.370856,0.928691,6000,100,1),
+(@GUID_GO+2,190236,668,3,1,4926.09,1554.96,163.292,-2.26562,0,0,0.999999,-0.001655,6000,100,1),
+(@GUID_GO+3,202302,668,3,1,5309.51,2006.64,709.341,5.50041,0,0,0.381473,-0.92438,604800,100,1),
+(@GUID_GO+4,202236,668,3,1,5309.51,2006.64,709.341,5.53575,0,0,0.365077,-0.930977,604800,100,1),
+(@GUID_GO+5,201596,668,3,1,5275.28,1694.23,786.147,0.981225,0,0,0.471166,0.882044,25,0,0),
+(@GUID_GO+6,500001,668,3,1,5323.61,1755.85,770.305,0.784186,0,0,0.382124,0.924111,604800,100,0),
+(@GUID_GO+7,196391,668,3,1,5232.31,1925.57,707.695,0.815481,0,0,0.396536,0.918019,300,0,1),
+(@GUID_GO+8,196392,668,3,1,5232.31,1925.57,707.695,0.815481,0,0,0.396536,0.918019,300,0,1),
+(@GUID_GO+9,202396,668,3,1,5434.27,1881.12,751.303,0.923328,0,0,0.445439,0.895312,604800,100,0),
+(@GUID_GO+10,201885,668,3,1,5494.3,1978.27,736.689,1.0885,0,0,0.517777,0.855516,604800,100,0),
+(@GUID_GO+11,197341,668,3,1,5359.24,2058.35,707.695,3.96022,0,0,0.917394,-0.397981,300,100,1),
+(@GUID_GO+12,201976,668,3,1,5264.6,1959.55,707.695,0.736951,0,0,0.360194,0.932877,300,100,0),
+(@GUID_GO+13,197342,668,3,1,5520.72,2228.89,733.011,0.778581,0,0,0.379532,0.925179,300,100,1),
+(@GUID_GO+14,197343,668,3,1,5582.96,2230.59,733.011,5.49098,0,0,0.385827,-0.922571,300,100,1),
+(@GUID_GO+15,201385,668,3,1,5540.39,2086.48,731.066,1.00057,0,0,0.479677,0.877445,604800,100,0),
+(@GUID_GO+16,202337,668,2,1,5252.33,1585.36,796.062,2.80195,0,0,0.985615,0.169007,604800,100,1),
+(@GUID_GO+17,202336,668,2,1,5264.22,1584.94,794.359,2.70142,0,0,0.975878,0.218315,604800,100,1),
+(@GUID_GO+18,202079,668,3,1,5248.58,1574.22,795.209,0,0,0,0,1,604800,100,1),
+(@GUID_GO+19,500002,668,3,1,5247.09,1586.39,773.922,5.86166,0,0,0.209207,-0.977871,300,0,1),
+(@GUID_GO+20,500003,668,3,1,5245.17,1582.11,761.72,5.86166,0,0,0.209207,-0.977871,300,0,1),
+(@GUID_GO+21,202212,668,1,1,5253.03,1585.13,796.089,2.75698,0,0,0.981566,0.191121,300,0,1),
+(@GUID_GO+22,201710,668,1,1,5262.5,1582.41,794.342,2.75698,0,0,0.981566,0.191121,300,0,1);
+
+-- Loot del Chest del final
+DELETE FROM `gameobject_loot_template` WHERE (`entry`=27993);
+INSERT INTO `gameobject_loot_template` VALUES 
+(27993, 43102, 100, 1, 0, 1, 1),
+(27993, 47241, 100, 1, 0, 1, 1),
+(27993, 50302, 0, 1, 1, 1, 1),
+(27993, 50303, 0, 1, 1, 1, 1),
+(27993, 50304, 0, 1, 2, 1, 1),
+(27993, 50305, 0, 1, 2, 1, 1),
+(27993, 50306, 0, 1, 1, 1, 1),
+(27993, 50308, 0, 1, 2, 1, 1),
+(27993, 50309, 0, 1, 1, 1, 1),
+(27993, 50310, 0, 1, 2, 1, 1),
+(27993, 50311, 0, 1, 2, 1, 1),
+(27993, 50312, 0, 1, 2, 1, 1),
+(27993, 50313, 0, 1, 1, 1, 1),
+(27993, 50314, 0, 1, 1, 1, 1);
+
+DELETE FROM `gameobject_loot_template` WHERE (`entry`=27985);
+INSERT INTO `gameobject_loot_template` VALUES 
+(27985, 47241, 100, 1, 0, 1, 1),
+(27985, 49839, 0, 1, 1, 1, 1),
+(27985, 49840, 0, 1, 1, 1, 1),
+(27985, 49841, 0, 1, 2, 1, 1),
+(27985, 49842, 0, 1, 2, 1, 1),
+(27985, 49843, 0, 1, 2, 1, 1),
+(27985, 49844, 0, 1, 1, 1, 1),
+(27985, 49845, 0, 1, 1, 1, 1),
+(27985, 49846, 0, 1, 1, 1, 1),
+(27985, 49847, 0, 1, 2, 1, 1),
+(27985, 49848, 0, 1, 2, 1, 1),
+(27985, 49849, 0, 1, 1, 1, 1),
+(27985, 49851, 0, 1, 2, 1, 1);
+
+-- Inmunidades.
+UPDATE `creature_template` SET `mechanic_immune_mask` = `mechanic_immune_mask`|1|2|8|16|32|64|128|256|512|1024|2048|4096|8192|65536|131072|524288|4194304|8388608|33554432|536870912 WHERE `entry` IN (SELECT `id`  FROM `creature` WHERE map=668);
+UPDATE `creature_template` SET `mechanic_immune_mask` = `mechanic_immune_mask`|1|2|8|16|32|64|128|256|512|1024|2048|4096|8192|65536|131072|524288|4194304|8388608|33554432|536870912 WHERE `entry` IN 
+(
+38112,
+38113,
+36723,
+37107,
+36954,
+37745,
+37158,
+37226,
+37225,
+37221,
+36955,
+37223,
+37554,
+37182,
+37833,
+38177,
+38173,
+38176,
+38175,
+38172,
+37906,
+37014,
+36940,
+36941,
+37069);
diff --git a/src/server/game/Scripting/ScriptLoader.cpp b/src/server/game/Scripting/ScriptLoader.cpp
index 9afcfea..06b9a26 100755
--- a/src/server/game/Scripting/ScriptLoader.cpp
+++ b/src/server/game/Scripting/ScriptLoader.cpp
@@ -470,6 +470,7 @@ void AddSC_instance_halls_of_reflection();   // Halls of Reflection
 void AddSC_halls_of_reflection();
 void AddSC_boss_falric();
 void AddSC_boss_marwyn();
+void AddSC_boss_lich_king_hr();
 void AddSC_boss_lord_marrowgar();       // Icecrown Citadel
 void AddSC_boss_lady_deathwhisper();
 void AddSC_boss_gunship_battle_wowrean();
@@ -1180,6 +1181,7 @@ void AddNorthrendScripts()
     AddSC_halls_of_reflection();
     AddSC_boss_falric();
     AddSC_boss_marwyn();
+    AddSC_boss_lich_king_hr();
     AddSC_boss_lord_marrowgar();        // Icecrown Citadel
     AddSC_boss_lady_deathwhisper();
     AddSC_boss_gunship_battle_wowrean();
diff --git a/src/server/scripts/Northrend/CMakeLists.txt b/src/server/scripts/Northrend/CMakeLists.txt
index b8e121e..bf303f3 100644
--- a/src/server/scripts/Northrend/CMakeLists.txt
+++ b/src/server/scripts/Northrend/CMakeLists.txt
@@ -56,6 +56,7 @@ set(scripts_STAT_SRCS
   Northrend/FrozenHalls/HallsOfReflection/instance_halls_of_reflection.cpp
   Northrend/FrozenHalls/HallsOfReflection/halls_of_reflection.cpp
   Northrend/FrozenHalls/HallsOfReflection/boss_marwyn.cpp
+  Northrend/FrozenHalls/HallsOfReflection/boss_the_lich_king_hor.cpp
   Northrend/FrozenHalls/PitOfSaron/boss_forgemaster_garfrost.cpp
   Northrend/FrozenHalls/PitOfSaron/boss_krickandick.cpp
   Northrend/FrozenHalls/PitOfSaron/pit_of_saron.cpp
diff --git a/src/server/scripts/Northrend/FrozenHalls/HallsOfReflection/boss_the_lich_king_hor.cpp b/src/server/scripts/Northrend/FrozenHalls/HallsOfReflection/boss_the_lich_king_hor.cpp
new file mode 100644
index 0000000..0867a46
--- /dev/null
+++ b/src/server/scripts/Northrend/FrozenHalls/HallsOfReflection/boss_the_lich_king_hor.cpp
@@ -0,0 +1,682 @@
+/*
+ * Copyright (C) 2008 - 2010 Trinity <http://www.trinitycore.org/>
+ *
+ * Copyright (C) 2006 - 2010 ScriptDev2 <https://scriptdev2.svn.sourceforge.net/>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+ */
+
+ /* ScriptData
+ SDName: boss_Lich_king
+ SD%Complete: 0%
+ SDComment: new script for tc implementation.
+ SDCategory: Halls of Reflection
+ EndScriptData */
+
+#include "ScriptPCH.h"
+#include "halls_of_reflection.h"
+#include "ScriptedEscortAI.h"
+
+enum
+{
+    SPELL_WINTER                       = 69780,
+    SPELL_FURY_OF_FROSTMOURNE          = 70063,
+    SPELL_SOUL_REAPER                  = 73797,
+    SPELL_RAISE_DEAD                   = 69818,
+    SPELL_ICE_PRISON                   = 69708,
+    SPELL_DARK_ARROW                   = 70194,
+    SPELL_HARVEST_SOUL                 = 70070,
+
+    //Raging gnoul
+    SPELL_EMERGE_VISUAL                = 50142,
+    SPELL_GNOUL_JUMP                   = 70150,
+
+    //Witch Doctor
+    SPELL_COURSE_OF_DOOM               = 70144,
+    H_SPELL_COURSE_OF_DOOM             = 70183,
+    SPELL_SHADOW_BOLT_VOLLEY           = 70145,
+    H_SPELL_SHADOW_BOLT_VOLLEY         = 70184,
+    SPELL_SHADOW_BOLT                  = 70080,
+    H_SPELL_SHADOW_BOLT                = 70182,
+
+    //Lumbering Abomination
+    SPELL_ABON_STRIKE                  = 40505,
+    SPELL_VOMIT_SPRAY                  = 70176,
+    H_SPELL_VOMIT_SPRAY                = 70181,
+
+    SAY_LICH_KING_WALL_01              = -1594486,
+    SAY_LICH_KING_WALL_02              = -1594491,
+    SAY_LICH_KING_GNOUL                = -1594482,
+    SAY_LICH_KING_ABON                 = -1594483,
+    SAY_LICH_KING_WINTER               = -1594481,
+    SAY_LICH_KING_END_DUN              = -1594504,
+    SAY_LICH_KING_WIN                  = -1594485,
+};
+
+class boss_lich_king_hor : public CreatureScript
+{
+public:
+    boss_lich_king_hor() : CreatureScript("boss_lich_king_hor") { }
+
+    CreatureAI* GetAI(Creature* creature) const
+    {
+        return new boss_lich_king_horAI(creature);
+    }
+
+    struct boss_lich_king_horAI : public npc_escortAI
+    {
+        boss_lich_king_horAI(Creature *creature) : npc_escortAI(creature)
+        {
+            pInstance = (InstanceScript*)creature->GetInstanceScript();
+            Reset();
+        }
+
+        InstanceScript* pInstance;
+        uint32 Step;
+        uint32 StepTimer;
+        uint32 uiWall;
+        bool StartEscort;
+        bool NonFight;
+        float walkSpeed;
+
+        void Reset()
+        {
+            if(!pInstance)
+                return;
+            NonFight = false;
+            StartEscort = false;
+            walkSpeed = 1.0f;
+            uiWall = 0;
+        }
+
+        void JustDied(Unit* pKiller) { }
+
+        void WaypointReached(uint32 i)
+        {
+            if(pInstance->GetData(DATA_ICE_WALL_1) == IN_PROGRESS)
+            {
+                uiWall = 1;
+                SetEscortPaused(true);
+            }
+
+            if(pInstance->GetData(DATA_ICE_WALL_2) == IN_PROGRESS)
+            {
+                uiWall = 2;
+                SetEscortPaused(true);
+            }
+
+            if(pInstance->GetData(DATA_ICE_WALL_3) == IN_PROGRESS)
+            {
+                uiWall = 3;
+                SetEscortPaused(true);
+            }
+
+            if(pInstance->GetData(DATA_ICE_WALL_4) == IN_PROGRESS)
+            {
+                uiWall = 4;
+                SetEscortPaused(true);
+            }
+
+            switch(i)
+            {
+                case 66:
+                    SetEscortPaused(true);
+                    pInstance->SetData(DATA_LICHKING_EVENT, SPECIAL);
+                    DoScriptText(SAY_LICH_KING_END_DUN, me);
+                    if(Creature* pLider = ((Creature*)Unit::GetUnit((*me), pInstance->GetData64(DATA_ESCAPE_LIDER))))
+                        me->CastSpell(pLider, SPELL_HARVEST_SOUL, false);
+                    me->setActive(false);
+                    break;
+            }
+        }
+
+        void AttackStart(Unit* who)
+        {
+            if (!pInstance || !who)
+                return;
+
+            if (NonFight)
+                return;
+
+            if(pInstance->GetData(DATA_LICHKING_EVENT) == IN_PROGRESS || who->GetTypeId() == TYPEID_PLAYER)
+                return;
+
+            npc_escortAI::AttackStart(who);
+        }
+
+        void JustSummoned(Creature* summoned)
+        {
+            if(!pInstance || !summoned)
+                return;
+
+            summoned->SetInCombatWithZone();
+            summoned->setActive(true);
+
+            pInstance->SetData(DATA_SUMMONS, 1);
+            if (Unit* pLider = Unit::GetUnit((*me), pInstance->GetData64(DATA_ESCAPE_LIDER)))
+            {
+                summoned->GetMotionMaster()->MoveChase(pLider);
+                summoned->AddThreat(pLider, 100.0f);
+            }
+        }
+
+        void CallGuard(uint32 GuardID)
+        {
+            me->SummonCreature(GuardID,(me->GetPositionX()-5)+rand()%10, (me->GetPositionY()-5)+rand()%10, me->GetPositionZ(),4.17f,TEMPSUMMON_TIMED_OR_DEAD_DESPAWN,360000);
+        }
+
+        void Wall01()
+        {
+            switch(Step)
+            {
+                case 0:
+                    pInstance->SetData(DATA_SUMMONS, 3);
+                    DoScriptText(SAY_LICH_KING_WALL_01, me);
+                    StepTimer = 2000;
+                    ++Step;
+                    break;
+                case 1:
+                    DoCast(me, SPELL_RAISE_DEAD);
+                    DoScriptText(SAY_LICH_KING_GNOUL, me);
+                    StepTimer = 7000;
+                    ++Step;
+                    break;
+                case 2:
+                    DoCast(me, SPELL_WINTER);
+                    DoScriptText(SAY_LICH_KING_WINTER, me);
+                    me->SetSpeed(MOVE_WALK, walkSpeed, true);
+                    StepTimer = 1000;
+                    ++Step;
+                    break;
+                case 3:
+                    StepTimer = 2000;
+                    ++Step;
+                    break;
+                case 4:
+                    CallGuard(NPC_RISEN_WITCH_DOCTOR);
+                    pInstance->SetData(DATA_ICE_WALL_1, DONE);
+                    StepTimer = 100;
+                    Step = 0;
+                    uiWall = 0;
+                    SetEscortPaused(false);
+                    break;
+            }
+        }
+
+        void Wall02()
+        {
+            switch(Step)
+            {
+                case 0:
+                    pInstance->SetData(DATA_SUMMONS, 3);
+                    DoScriptText(SAY_LICH_KING_GNOUL, me);
+                    DoCast(me, SPELL_RAISE_DEAD);
+                    StepTimer = 6000;
+                    ++Step;
+                    break;
+                case 1:
+                    CallGuard(NPC_RISEN_WITCH_DOCTOR);
+                    CallGuard(NPC_RISEN_WITCH_DOCTOR);
+                    CallGuard(NPC_ABON);
+                    pInstance->SetData(DATA_ICE_WALL_2, DONE);
+                    StepTimer = 5000;
+                    Step = 0;
+                    uiWall = 0;
+                    SetEscortPaused(false);
+                    break;
+            }
+        }
+
+        void Wall03()
+        {
+            switch(Step)
+            {
+                case 0:
+                    pInstance->SetData(DATA_SUMMONS, 3);
+                    DoCast(me, SPELL_RAISE_DEAD);
+                    DoScriptText(SAY_LICH_KING_GNOUL, me);
+                    StepTimer = 6000;
+                    ++Step;
+                    break;
+                case 1:
+                    DoScriptText(SAY_LICH_KING_ABON, me);
+                    CallGuard(NPC_RISEN_WITCH_DOCTOR);
+                    CallGuard(NPC_RISEN_WITCH_DOCTOR);
+                    CallGuard(NPC_RISEN_WITCH_DOCTOR);
+                    CallGuard(NPC_ABON);
+                    CallGuard(NPC_ABON);
+                    pInstance->SetData(DATA_ICE_WALL_3, DONE);
+                    StepTimer = 5000;
+                    Step = 0;
+                    uiWall = 0;
+                    SetEscortPaused(false);
+                    break;
+            }
+        }
+
+        void Wall04()
+        {
+            switch(Step)
+            {
+                case 0:
+                    pInstance->SetData(DATA_SUMMONS, 3);
+                    DoCast(me, SPELL_RAISE_DEAD);
+                    DoScriptText(SAY_LICH_KING_GNOUL, me);
+                    StepTimer = 6000;
+                    ++Step;
+                    break;
+                case 1:
+                    CallGuard(NPC_RISEN_WITCH_DOCTOR);
+                    CallGuard(NPC_RISEN_WITCH_DOCTOR);
+                    CallGuard(NPC_RISEN_WITCH_DOCTOR);
+                    CallGuard(NPC_ABON);
+                    CallGuard(NPC_ABON);
+                    StepTimer = 15000;
+                    ++Step;
+                    break;
+                case 2:
+                    DoScriptText(SAY_LICH_KING_ABON, me);
+                    CallGuard(NPC_RISEN_WITCH_DOCTOR);
+                    CallGuard(NPC_RISEN_WITCH_DOCTOR);
+                    pInstance->SetData(DATA_ICE_WALL_4, DONE);
+                    uiWall = 0;
+                    SetEscortPaused(false);
+                    ++Step;
+                    break;
+            }
+        }
+
+        void UpdateEscortAI(const uint32 diff)
+        {
+            if(!pInstance)
+                return;
+
+            if(pInstance->GetData(DATA_LICHKING_EVENT) == NOT_STARTED || pInstance->GetData(DATA_LICHKING_EVENT) == FAIL)
+            {
+                if (!UpdateVictim())
+                    return;
+
+                DoMeleeAttackIfReady();
+            }
+
+            if(me->isInCombat() && pInstance->GetData(DATA_LICHKING_EVENT) == IN_PROGRESS)
+            {
+                npc_escortAI::EnterEvadeMode();
+            }
+
+            // Start chase for leader
+            if(pInstance->GetData(DATA_LICHKING_EVENT) == IN_PROGRESS && StartEscort != true)
+            {
+                StartEscort = true;
+                me->RemoveAurasDueToSpell(SPELL_ICE_PRISON);
+                me->RemoveAurasDueToSpell(SPELL_DARK_ARROW);
+                me->setActive(true);
+                NonFight = true;
+                me->AttackStop();
+                me->SetSpeed(MOVE_WALK, 2.5f, true);
+                Start(false, false);
+                Step = 0;
+                StepTimer = 100;
+            }
+
+            // Leader caught, wipe
+            if (Creature* pLider = ((Creature*)Unit::GetUnit((*me), pInstance->GetData64(DATA_ESCAPE_LIDER))))
+            {
+                if (pLider->IsWithinDistInMap(me, 2.0f) && pInstance->GetData(DATA_LICHKING_EVENT) == IN_PROGRESS)
+                {
+                    me->setActive(false);
+                    SetEscortPaused(false);
+                    me->StopMoving();
+                    DoScriptText(SAY_LICH_KING_WIN, me);
+                    me->CastSpell(me, SPELL_FURY_OF_FROSTMOURNE, false);
+                    me->DealDamage(pLider, pLider->GetHealth(), NULL, DIRECT_DAMAGE, SPELL_SCHOOL_MASK_NORMAL, NULL, false);
+                }
+            }
+
+            if(uiWall == 1)
+            {
+                if(StepTimer < diff)
+                    Wall01();
+                else
+                    StepTimer -= diff;
+            }
+
+            if(uiWall == 2)
+            {
+                if(StepTimer < diff)
+                    Wall02();
+                else
+                    StepTimer -= diff;
+            }
+
+            if(uiWall == 3)
+            {
+                if(StepTimer < diff)
+                    Wall03();
+                else
+                    StepTimer -= diff;
+            }
+
+            if(uiWall == 4)
+            {
+                if(StepTimer < diff)
+                    Wall04();
+                else
+                    StepTimer -= diff;
+            }
+            return;
+        }
+    };
+};
+
+class npc_raging_gnoul : public CreatureScript
+{
+public:
+    npc_raging_gnoul() : CreatureScript("npc_raging_gnoul") { }
+
+    struct npc_raging_gnoulAI : public ScriptedAI
+    {
+        npc_raging_gnoulAI(Creature *creature) : ScriptedAI(creature)
+        {
+            pInstance = (InstanceScript*)creature->GetInstanceScript();
+            me->setActive(true);
+            Reset();
+        }
+
+        InstanceScript* pInstance;
+        uint32 EmergeTimer;
+        bool Emerge;
+        bool Jumped;
+        uint64 uiLiderGUID;
+
+        void Reset()
+        {
+            DoCast(me, SPELL_EMERGE_VISUAL);
+            EmergeTimer = 4000;
+            Emerge = false;
+            Jumped = false;
+        }
+
+        void JustDied(Unit* pKiller)
+        {
+            if(!pInstance)
+                return;
+
+            pInstance->SetData(DATA_SUMMONS, 0);
+        }
+
+        void AttackStart(Unit* who)
+        {
+            if (!who)
+                return;
+
+            if(Emerge == false)
+                return;
+
+            ScriptedAI::AttackStart(who);
+        }
+
+        void UpdateAI(const uint32 diff)
+        {
+            if(!pInstance)
+                return;
+
+            if(pInstance->GetData(DATA_LICHKING_EVENT) == IN_PROGRESS)
+            {
+                uiLiderGUID = pInstance->GetData64(DATA_ESCAPE_LIDER);
+                Creature* pLider = ((Creature*)Unit::GetUnit((*me), uiLiderGUID));
+
+                if(Emerge != true)
+                {
+                    if(EmergeTimer < diff)
+                    {
+                        //me->RemoveFlag(SPLINEFLAG_WALKING | MOVEMENTFLAG_WALKING, true);
+                        Emerge = true;
+                        uiLiderGUID = pInstance->GetData64(DATA_ESCAPE_LIDER);
+                        if(pLider)
+                        {
+                            DoResetThreat();
+                            me->AI()->AttackStart(pLider);
+                            me->GetMotionMaster()->Clear();
+                            me->GetMotionMaster()->MoveChase(pLider);
+                        }
+                    }
+                    else
+                        EmergeTimer -= diff;
+                }
+
+                if(Unit *target = SelectTarget(SELECT_TARGET_RANDOM, 0, 50.0f))
+                {
+                    if(!Jumped && me->IsWithinDistInMap(target, 30.0f) && !me->IsWithinDistInMap(target, 5.0f))
+                    {
+                        Jumped = true;
+                        DoCast(target, SPELL_GNOUL_JUMP);
+                    }
+                }
+            }
+            else if (pInstance->GetData(DATA_LICHKING_EVENT) == FAIL || pInstance->GetData(DATA_LICHKING_EVENT) == NOT_STARTED)
+                me->DespawnOrUnsummon();
+
+            DoMeleeAttackIfReady();
+        }
+    };
+
+    CreatureAI* GetAI(Creature* creature) const
+    {
+        return new npc_raging_gnoulAI(creature);
+    }
+
+};
+
+class npc_risen_witch_doctor : public CreatureScript
+{
+public:
+    npc_risen_witch_doctor() : CreatureScript("npc_risen_witch_doctor") { }
+
+    struct npc_risen_witch_doctorAI : public ScriptedAI
+    {
+        npc_risen_witch_doctorAI(Creature *creature) : ScriptedAI(creature)
+        {
+            pInstance = (InstanceScript*)creature->GetInstanceScript();
+            me->setActive(true);
+            Reset();
+        }
+
+        InstanceScript* pInstance;
+        uint32 EmergeTimer;
+        bool Emerge;
+        uint64 uiLiderGUID;
+        uint32 uiBoltTimer;
+        uint32 uiBoltVolleyTimer;
+        uint32 uiCurseTimer;
+
+        void Reset()
+        {
+            DoCast(me, SPELL_EMERGE_VISUAL);
+            EmergeTimer = 5000;
+            uiBoltTimer = 6000;
+            uiBoltVolleyTimer = 15000;
+            uiCurseTimer = 7000;
+            Emerge = false;
+        }
+
+        void JustDied(Unit* pKiller)
+        {
+            if(!pInstance)
+                return;
+
+            pInstance->SetData(DATA_SUMMONS, 0);
+
+        }
+
+        void AttackStart(Unit* who)
+        {
+            if (!who)
+                return;
+
+            if(Emerge == false)
+                return;
+
+            ScriptedAI::AttackStart(who);
+        }
+
+        void UpdateAI(const uint32 diff)
+        {
+            if(!pInstance)
+                return;
+
+            if(pInstance->GetData(DATA_LICHKING_EVENT) == IN_PROGRESS)
+            {
+                if(Emerge != true)
+                {
+                    if(EmergeTimer < diff)
+                    {
+                        Emerge = true;
+                        uiLiderGUID = pInstance->GetData64(DATA_ESCAPE_LIDER);
+                        if(Creature* pLider = ((Creature*)Unit::GetUnit((*me), uiLiderGUID)))
+                        {
+                            DoResetThreat();
+                            me->AI()->AttackStart(pLider);
+                            me->GetMotionMaster()->Clear();
+                            me->GetMotionMaster()->MoveChase(pLider);
+                        }
+                    }
+                    else
+                        EmergeTimer -= diff;
+                }
+
+                if (uiCurseTimer < diff)
+                {
+                    if(Unit *target = SelectTarget(SELECT_TARGET_RANDOM))
+                        DoCast(target, SPELL_COURSE_OF_DOOM);
+                    uiCurseTimer = urand(10000, 15000);
+                } else uiCurseTimer -= diff;
+
+                if (uiBoltTimer < diff)
+                {
+                    if(Unit *target = SelectTarget(SELECT_TARGET_TOPAGGRO))
+                        DoCast(target, SPELL_SHADOW_BOLT);
+                    uiBoltTimer = urand(2000, 3000);
+                } else uiBoltTimer -= diff;
+
+                if (uiBoltVolleyTimer < diff)
+                {
+                    if(Unit *target = SelectTarget(SELECT_TARGET_TOPAGGRO))
+                        DoCast(target, SPELL_SHADOW_BOLT_VOLLEY);
+                    uiBoltVolleyTimer = urand(15000, 22000);
+                } else uiBoltVolleyTimer -= diff;
+
+            }
+            else if (pInstance->GetData(DATA_LICHKING_EVENT) == FAIL || pInstance->GetData(DATA_LICHKING_EVENT) == NOT_STARTED)
+                me->DespawnOrUnsummon();
+
+            DoMeleeAttackIfReady();
+        }
+    };
+
+    CreatureAI* GetAI(Creature* creature) const
+    {
+        return new npc_risen_witch_doctorAI(creature);
+    }
+
+};
+
+class npc_abon : public CreatureScript
+{
+public:
+    npc_abon() : CreatureScript("npc_abon") { }
+
+    struct npc_abonAI : public ScriptedAI
+    {
+        npc_abonAI(Creature *creature) : ScriptedAI(creature)
+        {
+            pInstance = (InstanceScript*)creature->GetInstanceScript();
+            me->setActive(true);
+            Reset();
+        }
+
+        InstanceScript* pInstance;
+        uint64 uiLiderGUID;
+        bool Walk;
+        uint32 uiStrikeTimer;
+        uint32 uiVomitTimer;
+
+        void Reset()
+        {
+            Walk = false;
+            uiVomitTimer = 15000;
+            uiStrikeTimer = 6000;
+        }
+
+        void UpdateAI(const uint32 diff)
+        {
+            if(!pInstance) return;
+
+            if(pInstance->GetData(DATA_LICHKING_EVENT) == IN_PROGRESS)
+            {
+                if(Walk != true)
+                {
+                    Walk = true;
+                    uiLiderGUID = pInstance->GetData64(DATA_ESCAPE_LIDER);
+                    if(Creature* pLider = ((Creature*)Unit::GetUnit((*me), uiLiderGUID)))
+                    {
+                        DoResetThreat();
+                        me->AI()->AttackStart(pLider);
+                        me->GetMotionMaster()->Clear();
+                        me->GetMotionMaster()->MoveChase(pLider);
+                    }
+                }
+
+                if (uiStrikeTimer < diff)
+                {
+                    if(Unit *target = SelectTarget(SELECT_TARGET_TOPAGGRO))
+                        DoCast(target, SPELL_ABON_STRIKE);
+                    uiStrikeTimer = urand(7000, 9000);
+                } else uiStrikeTimer -= diff;
+
+                if (uiVomitTimer < diff)
+                {
+                    if(Unit *target = SelectTarget(SELECT_TARGET_TOPAGGRO))
+                        DoCast(target, SPELL_VOMIT_SPRAY);
+                    uiVomitTimer = urand(15000, 20000);
+                } else uiVomitTimer -= diff;
+            }
+            else if (pInstance->GetData(DATA_LICHKING_EVENT) == FAIL || pInstance->GetData(DATA_LICHKING_EVENT) == NOT_STARTED)
+                me->DespawnOrUnsummon();
+            DoMeleeAttackIfReady();
+        }
+
+        void JustDied(Unit* pKiller)
+        {
+            if(!pInstance)
+                return;
+
+            pInstance->SetData(DATA_SUMMONS, 0);
+        }
+    };
+
+    CreatureAI* GetAI(Creature* creature) const
+    {
+        return new npc_abonAI(creature);
+    }
+};
+
+void AddSC_boss_lich_king_hr()
+{
+    new boss_lich_king_hor();
+    new npc_raging_gnoul();
+    new npc_risen_witch_doctor();
+    new npc_abon();
+}
diff --git a/src/server/scripts/Northrend/FrozenHalls/HallsOfReflection/halls_of_reflection.cpp b/src/server/scripts/Northrend/FrozenHalls/HallsOfReflection/halls_of_reflection.cpp
index 1583bdb..7089883 100644
--- a/src/server/scripts/Northrend/FrozenHalls/HallsOfReflection/halls_of_reflection.cpp
+++ b/src/server/scripts/Northrend/FrozenHalls/HallsOfReflection/halls_of_reflection.cpp
@@ -17,6 +17,7 @@
 
 #include "ScriptPCH.h"
 #include "halls_of_reflection.h"
+#include "ScriptedEscortAI.h"
 
 enum Yells
 {
@@ -66,12 +67,18 @@ enum Yells
 
     SAY_JAINA_INTRO_END                           = -1668042,
     SAY_SYLVANAS_INTRO_END                        = -1668043,
+    SAY_LK_JAINA_INTRO_END                        = -1594473,
+    SAY_LK_SYLVANAS_INTRO_END                     = -1594474,
 };
 
 enum Events
 {
     EVENT_NONE,
 
+    EVENT_START_PREINTRO,
+    EVENT_PREINTRO_1,
+    EVENT_PREINTRO_2,
+
     EVENT_START_INTRO,
     EVENT_SKIP_INTRO,
 
@@ -120,6 +127,7 @@ enum Events
     EVENT_INTRO_LK_7,
     EVENT_INTRO_LK_8,
     EVENT_INTRO_LK_9,
+    EVENT_INTRO_LK_10,
 
     EVENT_INTRO_END,
 };
@@ -135,6 +143,17 @@ enum eEnum
     QUEST_WRATH_OF_THE_LICH_KING_H2               = 24802,
 };
 
+enum Spells
+{
+    SPELL_CAST_VISUAL                  = 65633, //Jaina/Sylavana lo lanzan para invocar a uther
+    SPELL_BOSS_SPAWN_AURA              = 72712, //Falric and Marwyn
+    SPELL_UTHER_DESPAWN                = 70693,
+    SPELL_TAKE_FROSTMOURNE             = 72729,
+    SPELL_FROSTMOURNE_DESPAWN          = 72726,
+    SPELL_FROSTMOURNE_VISUAL           = 73220,
+    SPELL_FROSTMOURNE_SOUNDS           = 70667,
+};
+
 const Position HallsofReflectionLocs[]=
 {
     {5283.234863f, 1990.946777f, 707.695679f, 0.929097f},   // 2 Loralen Follows
@@ -143,6 +162,7 @@ const Position HallsofReflectionLocs[]=
 };
 
 const Position SpawnPos              = {5262.540527f, 1949.693726f, 707.695007f, 0.808736f}; // Jaina/Sylvanas Beginning Position
+const Position MoveDoorPos           = {5268.254395f, 1955.522705f, 707.699585f, 1.277278f};
 const Position MoveThronePos         = {5306.952148f, 1998.499023f, 709.341431f, 1.277278f}; // Jaina/Sylvanas walks to throne
 const Position UtherSpawnPos         = {5308.310059f, 2003.857178f, 709.341431f, 4.650315f};
 const Position LichKingSpawnPos      = {5362.917480f, 2062.307129f, 707.695374f, 3.945812f};
@@ -186,12 +206,12 @@ public:
 
         QuestStatus status = player->GetQuestStatus(m_isSylvana ? QUEST_DELIVRANCE_FROM_THE_PIT_H2 : QUEST_DELIVRANCE_FROM_THE_PIT_A2);
         if (status == QUEST_STATUS_COMPLETE || status == QUEST_STATUS_REWARDED)
-            player->ADD_GOSSIP_ITEM( 0, "Can you remove the sword?", GOSSIP_SENDER_MAIN, GOSSIP_ACTION_INFO_DEF+1);
+            player->ADD_GOSSIP_ITEM( 0, "Puedes bajar la espada?", GOSSIP_SENDER_MAIN, GOSSIP_ACTION_INFO_DEF+1);
 
         // once last quest is completed, she offers this shortcut of the starting event
-        status = player->GetQuestStatus(m_isSylvana ? QUEST_WRATH_OF_THE_LICH_KING_H2 : QUEST_WRATH_OF_THE_LICH_KING_A2);
-        if (status == QUEST_STATUS_COMPLETE || status == QUEST_STATUS_REWARDED)
-            player->ADD_GOSSIP_ITEM( 0, "Dark Lady, I think I hear Arthas coming. Whatever you're going to do, do it quickly.", GOSSIP_SENDER_MAIN, GOSSIP_ACTION_INFO_DEF+2);
+        QuestStatus status2 = player->GetQuestStatus(m_isSylvana ? QUEST_WRATH_OF_THE_LICH_KING_H2 : QUEST_WRATH_OF_THE_LICH_KING_A2);
+        if (status2 == QUEST_STATUS_COMPLETE || status2 == QUEST_STATUS_REWARDED)
+            player->ADD_GOSSIP_ITEM( 0, "Oigo a Arthas acercarse. Sea lo que sea lo que tengas que hacer, hazlo rapido.", GOSSIP_SENDER_MAIN, GOSSIP_ACTION_INFO_DEF+2);
 
         player->SEND_GOSSIP_MENU(DEFAULT_GOSSIP_MESSAGE, creature->GetGUID());
         return true;
@@ -233,7 +253,7 @@ public:
             switch (actionId)
             {
                 case ACTION_START_INTRO:
-                    events.ScheduleEvent(EVENT_START_INTRO, 0);
+                    events.ScheduleEvent(EVENT_START_PREINTRO, 0);
                     break;
                 case ACTION_SKIP_INTRO:
                     events.ScheduleEvent(EVENT_SKIP_INTRO, 0);
@@ -246,7 +266,28 @@ public:
             events.Update(diff);
             switch (events.ExecuteEvent())
             {
+                case EVENT_START_PREINTRO:
+                    me->RemoveUnitMovementFlag(MOVEMENTFLAG_WALKING);
+                    me->GetMotionMaster()->MovePoint(0, MoveDoorPos);
+
+                    if (instance->GetData(DATA_TEAM_IN_INSTANCE) == ALLIANCE)
+                        events.ScheduleEvent(EVENT_PREINTRO_1, 0);
+                    else
+                        events.ScheduleEvent(EVENT_START_INTRO, 0);
+                    break;
+
+                case EVENT_PREINTRO_1:
+                        DoScriptText(SAY_JAINA_INTRO_1, me);
+                        events.ScheduleEvent(EVENT_PREINTRO_2, 6000);
+                    break;
+
+                case EVENT_PREINTRO_2:
+                        DoScriptText(SAY_JAINA_INTRO_2, me);
+                        events.ScheduleEvent(EVENT_START_INTRO, 7000);
+                    break;
+
                 case EVENT_START_INTRO:
+                    me->RemoveUnitMovementFlag(MOVEMENTFLAG_WALKING);
                     me->GetMotionMaster()->MovePoint(0, MoveThronePos);
                     // Begining of intro is differents between factions as the speech sequence and timers are differents.
                     if (instance->GetData(DATA_TEAM_IN_INSTANCE) == ALLIANCE)
@@ -265,7 +306,8 @@ public:
                     events.ScheduleEvent(EVENT_INTRO_A2_3, 10000);
                     break;
                 case EVENT_INTRO_A2_3:
-                    // TODO: she's doing some kind of spell casting emote
+                    DoCast(me, SPELL_CAST_VISUAL);
+                    me->CastSpell(me, SPELL_FROSTMOURNE_SOUNDS, true);
                     instance->HandleGameObject(instance->GetData64(DATA_FROSTMOURNE), true);
                     events.ScheduleEvent(EVENT_INTRO_A2_4, 10000);
                     break;
@@ -276,6 +318,8 @@ public:
                         pUther->GetMotionMaster()->MoveIdle();
                         pUther->SetReactState(REACT_PASSIVE); // be sure he will not aggro arthas
                         uiUther = pUther->GetGUID();
+                        me->SetUInt64Value(UNIT_FIELD_TARGET, uiUther);
+                        pUther->SetUInt64Value(UNIT_FIELD_TARGET, me->GetGUID());
                     }
                     events.ScheduleEvent(EVENT_INTRO_A2_5, 2000);
                     break;
@@ -362,7 +406,9 @@ public:
                     break;
                 case EVENT_INTRO_H2_3:
                     DoScriptText(SAY_SYLVANAS_INTRO_3, me);
-                    // TODO: she's doing some kind of spell casting emote
+                    DoCast(me, SPELL_CAST_VISUAL);
+                    instance->HandleGameObject(instance->GetData64(DATA_FROSTMOURNE), true);
+                    me->CastSpell(me, SPELL_FROSTMOURNE_SOUNDS, true);
                     events.ScheduleEvent(EVENT_INTRO_H2_4, 6000);
                     break;
                 case EVENT_INTRO_H2_4:
@@ -372,6 +418,8 @@ public:
                         pUther->GetMotionMaster()->MoveIdle();
                         pUther->SetReactState(REACT_PASSIVE); // be sure he will not aggro arthas
                         uiUther = pUther->GetGUID();
+                        me->SetUInt64Value(UNIT_FIELD_TARGET, uiUther);
+                        pUther->SetUInt64Value(UNIT_FIELD_TARGET, me->GetGUID());
                     }
                     events.ScheduleEvent(EVENT_INTRO_H2_5, 2000);
                     break;
@@ -434,13 +482,21 @@ public:
                     // Spawn LK in front of door, and make him move to the sword.
                     if (Creature* pLichKing = me->SummonCreature(NPC_LICH_KING_EVENT, LichKingSpawnPos, TEMPSUMMON_MANUAL_DESPAWN))
                     {
+                        pLichKing->SetUnitMovementFlags(MOVEMENTFLAG_WALKING);
                         pLichKing->GetMotionMaster()->MovePoint(0, LichKingMoveThronePos);
                         pLichKing->SetReactState(REACT_PASSIVE);
                         uiLichKing = pLichKing->GetGUID();
+
+                        if(GameObject* pGate = instance->instance->GetGameObject(instance->GetData64(DATA_FROSTWORN_DOOR)))
+                             pGate->SetGoState(GO_STATE_ACTIVE);
+
+                        me->SetUInt64Value(UNIT_FIELD_TARGET, uiLichKing);
+                        pLichKing->SetUInt64Value(UNIT_FIELD_TARGET, me->GetGUID());
                     }
 
                     if (Creature* pUther = me->GetCreature(*me, uiUther))
                     {
+                        pUther->SetUInt32Value(UNIT_NPC_EMOTESTATE, EMOTE_STATE_COWER);
                         if (instance->GetData(DATA_TEAM_IN_INSTANCE) == ALLIANCE)
                             DoScriptText(SAY_UTHER_INTRO_A2_9, pUther);
                         else
@@ -453,6 +509,8 @@ public:
                 case EVENT_INTRO_LK_2:
                      if (Creature* pLichKing = me->GetCreature(*me, uiLichKing))
                          DoScriptText(SAY_LK_INTRO_1, pLichKing);
+                    if(GameObject* pGate = instance->instance->GetGameObject(instance->GetData64(DATA_FROSTWORN_DOOR)))
+                        pGate->SetGoState(GO_STATE_READY);
                      events.ScheduleEvent(EVENT_INTRO_LK_3, 2000);
                      break;
 
@@ -460,33 +518,48 @@ public:
                      // The Lich King banishes Uther to the abyss.
                      if (Creature* pUther = me->GetCreature(*me, uiUther))
                      {
+                         pUther->CastSpell(pUther, SPELL_UTHER_DESPAWN, true);
                          pUther->DisappearAndDie();
                          uiUther = 0;
                      }
-
-                     // He steps forward and removes the runeblade from the heap of skulls.
-
-                     events.ScheduleEvent(EVENT_INTRO_LK_4, 4000);
+                     events.ScheduleEvent(EVENT_INTRO_LK_4, 5000);
                      break;
 
                 case EVENT_INTRO_LK_4:
                       if (Creature* pLichKing = me->GetCreature(*me, uiLichKing))
                           DoScriptText(SAY_LK_INTRO_2, pLichKing);
+                     // He steps forward and removes the runeblade from the heap of skulls.
+                      if (GameObject *pFrostmourne = me->FindNearestGameObject(GO_FROSTMOURNE, 11.0f))
+                         pFrostmourne->SetPhaseMask(0,true);
+
+                      if (Creature* pLichKing = me->GetCreature(*me, uiLichKing))
+                      {
+                          pLichKing->CastSpell(pLichKing, SPELL_TAKE_FROSTMOURNE, true);
+                          pLichKing->CastSpell(pLichKing, SPELL_FROSTMOURNE_VISUAL, true);
+                      }
+
+                      me->RemoveAllAuras();
+
                     events.ScheduleEvent(EVENT_INTRO_LK_5, 10000);
                     break;
 
                 case EVENT_INTRO_LK_5:
                     // summon Falric and Marwyn. then go back to the door
                     if (Creature* pFalric = me->GetCreature(*me, instance->GetData64(DATA_FALRIC)))
+                    {
+                        pFalric->CastSpell(pFalric, SPELL_BOSS_SPAWN_AURA, true);
                         pFalric->SetVisible(true);
+                        pFalric->GetMotionMaster()->MovePoint(0, 5283.309f, 2031.173f, 709.319f);
+                    }
                     if (Creature* pMarwyn = me->GetCreature(*me, instance->GetData64(DATA_MARWYN)))
+                    {
+                        pMarwyn->CastSpell(pMarwyn, SPELL_BOSS_SPAWN_AURA, true);
                         pMarwyn->SetVisible(true);
+                        pMarwyn->GetMotionMaster()->MovePoint(0, 5335.585f, 1981.439f, 709.319f);
+                    }
 
                     if (Creature* pLichKing = me->GetCreature(*me, uiLichKing))
-                    {
-                        pLichKing->GetMotionMaster()->MovePoint(0, LichKingSpawnPos);
                         DoScriptText(SAY_LK_INTRO_3, pLichKing);
-                    }
 
                     events.ScheduleEvent(EVENT_INTRO_LK_6, 8000);
                     break;
@@ -502,6 +575,14 @@ public:
                     if (Creature* pMarwyn = me->GetCreature(*me, instance->GetData64(DATA_MARWYN)))
                         DoScriptText(SAY_MARWYN_INTRO_1, pMarwyn);
 
+                    if (Creature* pLichKing = me->GetCreature(*me, uiLichKing))
+                    {
+                        if(GameObject* pGate = instance->instance->GetGameObject(instance->GetData64(DATA_FROSTWORN_DOOR)))
+                            pGate->SetGoState(GO_STATE_ACTIVE);
+                        pLichKing->SetUnitMovementFlags(MOVEMENTFLAG_WALKING);
+                        pLichKing->GetMotionMaster()->MovePoint(0, LichKingMoveAwayPos);
+                    }
+
                     events.ScheduleEvent(EVENT_INTRO_LK_8, 2000);
                     break;
 
@@ -518,31 +599,59 @@ public:
                     else
                         DoScriptText(SAY_SYLVANAS_INTRO_END, me);
 
-                    me->GetMotionMaster()->MovePoint(0, LichKingSpawnPos);
-                    // TODO: Loralen/Koreln shall run also
-                    events.ScheduleEvent(EVENT_INTRO_END, 10000);
+                    me->GetMotionMaster()->MovePoint(0, LichKingMoveAwayPos);
+
+                    if (Creature* pLichKing = me->GetCreature(*me, uiLichKing))
+                    {
+                        pLichKing->RemoveUnitMovementFlag(MOVEMENTFLAG_WALKING);
+                        pLichKing->GetMotionMaster()->MovePoint(0, LichKingMoveAwayPos);
+                    }
+
+                    events.ScheduleEvent(EVENT_INTRO_LK_10, 5000);
                     break;
 
+                case EVENT_INTRO_LK_10:
+                     if (Creature* pLichKing = me->GetCreature(*me, uiLichKing))
+                         if (instance->GetData(DATA_TEAM_IN_INSTANCE) == ALLIANCE)
+                            DoScriptText(SAY_LK_JAINA_INTRO_END, pLichKing);
+                         else
+                             DoScriptText(SAY_LK_SYLVANAS_INTRO_END, pLichKing);
+
+                     events.ScheduleEvent(EVENT_INTRO_END, 7000);
+                     break;
+
                 case EVENT_INTRO_END:
                     if (instance)
+                    {
+                        instance->SetData(DATA_INTRO_EVENT, DONE);
                         instance->SetData(DATA_WAVE_COUNT, SPECIAL);   // start first wave
+                    }
+
+                    if(GameObject* pGate = instance->instance->GetGameObject(instance->GetData64(DATA_FROSTWORN_DOOR)))
+                        pGate->SetGoState(GO_STATE_READY);
 
                     // Loralen or Koreln disappearAndDie()
                     me->DisappearAndDie();
+                    if (Creature* pLichKing = me->GetCreature(*me, uiLichKing))
+                        pLichKing->DisappearAndDie();
+
                     break;
 
                 case EVENT_SKIP_INTRO:
-                    // TODO: implement
-
-                    if (Creature* pFalric = me->GetCreature(*me, instance->GetData64(DATA_FALRIC)))
-                        pFalric->SetVisible(true);
-                    if (Creature* pMarwyn = me->GetCreature(*me, instance->GetData64(DATA_MARWYN)))
-                        pMarwyn->SetVisible(true);
-
-                    me->GetMotionMaster()->MovePoint(0, LichKingSpawnPos);
-                    // TODO: Loralen/Koreln shall run also
+                   // Spawn LK in front of door, and make him move to the sword.
+                    if (Creature* pLichKing = me->SummonCreature(NPC_LICH_KING_EVENT, LichKingSpawnPos, TEMPSUMMON_MANUAL_DESPAWN))
+                    {
+                        pLichKing->SetUnitMovementFlags(MOVEMENTFLAG_WALKING);
+                        pLichKing->GetMotionMaster()->MovePoint(0, LichKingMoveThronePos);
+                        pLichKing->SetReactState(REACT_PASSIVE);
+                        uiLichKing = pLichKing->GetGUID();
+                        me->SetUInt64Value(UNIT_FIELD_TARGET, uiLichKing);
+                        pLichKing->SetUInt64Value(UNIT_FIELD_TARGET, me->GetGUID());
+                    }
 
-                    events.ScheduleEvent(EVENT_INTRO_END, 15000);
+                    me->RemoveUnitMovementFlag(MOVEMENTFLAG_WALKING);
+                    me->GetMotionMaster()->MovePoint(0, MoveThronePos);
+                    events.ScheduleEvent(EVENT_INTRO_LK_4, 20000);
                     break;
             }
         }
@@ -584,6 +693,9 @@ enum TrashSpells
     SPELL_CURSED_ARROW                            = 72222,
     SPELL_FROST_TRAP                              = 72215,
     SPELL_ICE_SHOT                                = 72268,
+
+    // Quel'Delar Event
+    SPELL_QUELDELAR_AURA                          = 70013,
 };
 
 enum TrashEvents
@@ -1013,14 +1125,958 @@ public:
 
 };
 
+enum GENERAL_EVENT
+{
+    SAY_AGGRO                    = -1594519,
+    SAY_DEATH                    = -1594520,
+
+    SPELL_SHIELD_THROWN          = 69222,
+    H_SPELL_SHIELD_THROWN        = 73076,
+    SPELL_SPIKE                  = 69184,
+    H_SPELL_SPIKE                = 70399,
+    SPELL_CLONE_NAME             = 57507,
+    SPELL_CLONE_MODEL            = 45204,
+
+    // Reflection'Spells
+    SPELL_BALEFUL_STRIKE         = 69933,
+    SPELL_SPIRIT_BURST           = 69900,
+    H_SPELL_BALEFUL_STRIKE       = 70400,
+    H_SPELL_SPIRIT_BURST         = 73046,
+};
+
+class npc_frostworn_general : public CreatureScript
+{
+public:
+    npc_frostworn_general() : CreatureScript("npc_frostworn_general") { }
+
+    struct npc_frostworn_generalAI : public ScriptedAI
+    {
+        npc_frostworn_generalAI(Creature *creature) : ScriptedAI(creature)
+        {
+            instance = (InstanceScript*)creature->GetInstanceScript();
+            Reset();
+        }
+
+        InstanceScript* instance;
+
+        uint32 uiShieldTimer;
+        uint32 uiSpikeTimer;
+        uint32 uiCloneTimer;
+
+        void Reset()
+        {
+            if (!instance)
+                return;
+            uiShieldTimer = 5000;
+            uiSpikeTimer = 14000;
+            uiCloneTimer = 22000;
+            instance->SetData(DATA_FROSWORN_EVENT, NOT_STARTED);
+            me->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NON_ATTACKABLE);
+        }
+
+        void JustDied(Unit* pKiller)
+        {
+            if (!instance)
+                return;
+            DoScriptText(SAY_DEATH, me);
+            instance->SetData(DATA_FROSWORN_EVENT, DONE);
+        }
+
+        void MoveInLineOfSight(Unit* who)
+        {
+            if (!instance)
+                return;
+
+            if (me->getVictim())
+                return;
+
+            if (who->GetTypeId() != TYPEID_PLAYER
+                || instance->GetData(DATA_MARWYN_EVENT) != DONE
+                || !me->IsWithinDistInMap(who, 20.0f)
+                ) return;
+
+            if (Player* player = (Player*)who)
+                if (player->isGameMaster())
+                    return;
+
+            me->RemoveFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NON_ATTACKABLE);
+
+            AttackStart(who);
+        }
+
+        void EnterCombat(Unit* victim)
+        {
+            if (!instance)
+                return;
+            DoScriptText(SAY_AGGRO, me);
+            instance->SetData(DATA_FROSWORN_EVENT, IN_PROGRESS);
+        }
+
+        void UpdateAI(const uint32 uiDiff)
+        {
+            if(!UpdateVictim())
+                return;
+
+            if(uiShieldTimer < uiDiff)
+            {
+                if(Unit *target = SelectTarget(SELECT_TARGET_RANDOM, 0))
+                   DoCast(target, SPELL_SHIELD_THROWN);
+                uiShieldTimer = urand(8000, 12000);
+            }
+            else
+                uiShieldTimer -= uiDiff;
+
+            if (uiSpikeTimer < uiDiff)
+            {
+                if(Unit *target = SelectTarget(SELECT_TARGET_RANDOM, 0))
+                    DoCast(target, SPELL_SPIKE);
+                uiSpikeTimer = urand(15000, 20000);
+            }
+            else
+                uiSpikeTimer -= uiDiff;
+
+            if (uiCloneTimer < uiDiff)
+            {
+                SummonClones();
+                uiCloneTimer = 60000;
+            }
+            else
+                uiCloneTimer -= uiDiff;
+
+            DoMeleeAttackIfReady();
+        }
+
+        void SummonClones()
+        {
+            std::list<Unit *> playerList;
+            SelectTargetList(playerList, 5, SELECT_TARGET_TOPAGGRO, 0, true);
+            for (std::list<Unit*>::const_iterator itr = playerList.begin(); itr != playerList.end(); ++itr)
+            {
+                Unit* pTemp = (*itr);
+                Creature* pReflection = me->SummonCreature(NPC_REFLECTION, pTemp->GetPositionX(), pTemp->GetPositionY(), pTemp->GetPositionZ(), pTemp->GetOrientation(), TEMPSUMMON_TIMED_DESPAWN_OUT_OF_COMBAT, 3000);
+                pReflection->SetName(pTemp->GetName());
+                pTemp->CastSpell(pReflection, SPELL_CLONE_NAME, true);
+                pTemp->CastSpell(pReflection, SPELL_CLONE_MODEL, true);
+                pReflection->setFaction(me->getFaction());
+                pReflection->AI()->AttackStart(pTemp);
+            }
+
+        }
+    };
+    CreatureAI* GetAI(Creature* creature) const
+    {
+        return new npc_frostworn_generalAI(creature);
+    }
+};
+
+class npc_spiritual_reflection : public CreatureScript
+{
+public:
+    npc_spiritual_reflection() : CreatureScript("npc_spiritual_reflection") { }
+
+    struct npc_spiritual_reflectionAI : public ScriptedAI
+    {
+        npc_spiritual_reflectionAI(Creature *creature) : ScriptedAI(creature)
+        {
+            Reset();
+        }
+
+        InstanceScript* instance;
+        uint32 uiStrikeTimer;
+
+        void Reset()
+        {
+            uiStrikeTimer = urand(1000,3000);
+        }
+
+        void JustDied(Unit* pKiller)
+        {
+            DoCast(pKiller, SPELL_SPIRIT_BURST);
+        }
+
+        void UpdateAI(const uint32 uiDiff)
+        {
+            if(!UpdateVictim())
+                return;
+
+            if(uiStrikeTimer < uiDiff)
+            {
+                if(Unit *target = SelectTarget(SELECT_TARGET_RANDOM, 0))
+                   DoCast(target, SPELL_BALEFUL_STRIKE);
+                uiStrikeTimer = urand(3000, 8000);
+            }
+            else
+                uiStrikeTimer -= uiDiff;
+
+            DoMeleeAttackIfReady();
+        }
+    };
+    CreatureAI* GetAI(Creature* creature) const
+    {
+        return new npc_spiritual_reflectionAI(creature);
+    }
+};
+
+enum Defs
+{
+    /*INTRO - Pre Escape*/
+    SAY_LICH_KING_AGGRO_A              = -1594477,
+    SAY_LICH_KING_AGGRO_H              = -1594478,
+    SAY_JAINA_AGGRO                    = -1594479,
+    SAY_SYLVANA_AGGRO                  = -1594480,
+
+    /*ESCAPE*/
+    SAY_JAINA_WALL_01                  = -1594487,
+    SAY_SYLVANA_WALL_01                = -1594488,
+    SAY_JAINA_WALL_02                  = -1594489,
+    SAY_SYLVANA_WALL_02                = -1594490,
+    SAY_LICH_KING_WALL_02              = -1594491,
+    SAY_LICH_KING_WALL_03              = -1594492,
+    SAY_LICH_KING_WALL_04              = -1594493,
+    SAY_JAINA_WALL_03                  = -1594494,
+    SAY_JAINA_WALL_04                  = -1594495,
+    SAY_SYLVANA_WALL_03                = -1594496,
+    SAY_SYLVANA_WALL_04                = -1594497,
+    SAY_JAINA_ESCAPE_01                = -1594498,
+    SAY_JAINA_ESCAPE_02                = -1594499,
+    SAY_SYLVANA_ESCAPE_01              = -1594500,
+    SAY_SYLVANA_ESCAPE_02              = -1594501,
+    SAY_JAINA_TRAP                     = -1594502,
+    SAY_SYLVANA_TRAP                   = -1594503,
+    SAY_MATHEAS_JAINA                  = -1594505,
+    SAY_JAINA_FIRE                     = -1594526,
+    SAY_SYLVANA_FIRE                   = -1594522,
+    SAY_SYLVANA_FINAL_1                = -1594523,
+    SAY_SYLVANA_FINAL_2                = -1594521,
+    SAY_JAINA_FINAL_1                  = -1594527,
+    SAY_JAINA_FINAL_2                  = -1594524,
+    SAY_JAINA_FINAL_3                  = -1594525,
+    SAY_LICH_KING_END_01               = -1594506,
+    SAY_LICH_KING_END_02               = -1594507,
+    SAY_LICH_KING_END_03               = -1594508,
+
+    /*SPELLS AND VISUAL EFFECTS*/
+    SPELL_WINTER                       = 69780,
+    SPELL_FURY_OF_FROSTMOURNE          = 70063,
+    SPELL_ICE_PRISON_VISUAL            = 69708,
+    SPELL_DARK_ARROW                   = 70194,
+    SPELL_ICE_BARRIER                  = 69787,
+    SPELL_DESTROY_ICE_WALL_01          = 69784, //Jaina
+    SPELL_DESTROY_ICE_WALL_03          = 70225, //Sylvana
+    SPELL_SYLVANA_JUMP                 = 68339,
+    SPELL_SYLVANA_STEP                 = 69087,
+    SPELL_FIRE_CANNON                  = 67461,
+
+    FACTION                            = 2076,
+};
+
+const Position CannonSpawns[4] =
+{
+    {5230.00f, 1658.75f, 802.22f, 0.00f},
+    {5245.74f, 1644.44f, 802.35f, 0.00f},
+    {5260.64f, 1636.07f, 802.16f, 0.00f},
+    {5275.90f, 1633.22f, 802.25f, 0.00f},
+};
+
+class npc_jaina_and_sylvana_hor_part2 : public CreatureScript
+{
+public:
+    npc_jaina_and_sylvana_hor_part2() : CreatureScript("npc_jaina_and_sylvana_hor_part2") { }
+
+    bool OnGossipSelect(Player* player, Creature* creature, uint32 uiSender, uint32 uiAction)
+    {
+        InstanceScript* m_pInstance = (InstanceScript*)creature->GetInstanceScript();
+        switch (uiAction)
+        {
+            case GOSSIP_ACTION_INFO_DEF+1:
+                player->CLOSE_GOSSIP_MENU();
+                ((npc_jaina_and_sylvana_hor_part2AI*)creature->AI())->Start(false,true);
+                creature->RemoveFlag(UNIT_NPC_FLAGS, UNIT_NPC_FLAG_QUESTGIVER);
+                creature->RemoveFlag(UNIT_NPC_FLAGS, UNIT_NPC_FLAG_GOSSIP);
+                creature->SetUInt64Value(UNIT_FIELD_TARGET, 0);
+                creature->setActive(true);
+
+                if(m_pInstance)
+                {
+                    m_pInstance->SetData64(DATA_ESCAPE_LIDER, creature->GetGUID());
+                    m_pInstance->SetData(DATA_LICHKING_EVENT, IN_PROGRESS);
+                }
+                return true;
+            default:
+                return false;
+        }
+    }
+
+    bool OnGossipHello(Player* player, Creature* creature)
+    {
+        InstanceScript*   m_pInstance = (InstanceScript*)creature->GetInstanceScript();
+
+        if(!m_pInstance)
+            return false;
+
+        if(m_pInstance->GetData(DATA_LICHKING_EVENT) == DONE)
+            return false;
+
+        if(creature->isQuestGiver())
+           player->PrepareQuestMenu( creature->GetGUID());
+
+        player->ADD_GOSSIP_ITEM(GOSSIP_ICON_CHAT, "Vamos!", GOSSIP_SENDER_MAIN, GOSSIP_ACTION_INFO_DEF+1);
+
+        player->SEND_GOSSIP_MENU(player->GetGossipTextId(creature), creature->GetGUID());
+
+        return true;
+    }
+
+    CreatureAI* GetAI(Creature* creature) const
+    {
+        return new npc_jaina_and_sylvana_hor_part2AI(creature);
+    }
+
+    struct npc_jaina_and_sylvana_hor_part2AI : public npc_escortAI
+    {
+        npc_jaina_and_sylvana_hor_part2AI(Creature *creature) : npc_escortAI(creature)
+        {
+            m_pInstance = (InstanceScript*)creature->GetInstanceScript();
+            Reset();
+        }
+
+        InstanceScript* m_pInstance;
+
+        uint32 CastTimer;
+        uint32 StepTimer;
+        uint32 Step;
+        int32 HoldTimer;
+        uint32 Count;
+        bool Fight;
+        bool Event;
+        bool PreFight;
+        bool WallCast;
+        uint64 m_uiLichKingGUID;
+        uint64 m_uiLiderGUID;
+        uint64 m_uiIceWallGUID;
+        uint64 m_uipWallTargetGUID;
+        uint64 uiCaptain;
+        Creature* pLichKing;
+        uint32 m_chestID;
+
+        void Reset()
+        {
+            if(!m_pInstance)
+                return;
+
+            if(m_pInstance->GetData(DATA_LICHKING_EVENT) == IN_PROGRESS)
+                return;
+
+            Step = 0;
+            StepTimer = 500;
+            Fight = true;
+            me->RemoveFlag(UNIT_NPC_FLAGS, UNIT_NPC_FLAG_QUESTGIVER);
+            me->RemoveFlag(UNIT_NPC_FLAGS, UNIT_NPC_FLAG_GOSSIP);
+            m_uipWallTargetGUID = 0;
+
+            if(me->GetEntry() == NPC_JAINA_OUTRO)
+            {
+                me->CastSpell(me, SPELL_ICE_BARRIER, false);
+                me->SetUInt32Value(UNIT_NPC_EMOTESTATE, EMOTE_STATE_READY2HL);
+            }
+            if(m_pInstance->GetData(DATA_LICHKING_EVENT) == DONE)
+                me->SetVisible(false);
+
+        }
+
+        void AttackStart(Unit* who)
+        {
+            if(!who)
+                return;
+
+            if(me->GetEntry() != NPC_SYLVANA_OUTRO)
+                return;
+
+            if(m_pInstance->GetData(DATA_LICHKING_EVENT) == IN_PROGRESS || Fight != true)
+                return;
+
+            npc_escortAI::AttackStart(who);
+
+        }
+
+        void JustDied(Unit* pKiller)
+        {
+            if(!m_pInstance)
+                return;
+            m_pInstance->SetData(DATA_LICHKING_EVENT, FAIL);
+        }
+
+        void WaypointReached(uint32 i)
+        {
+            switch(i)
+            {
+                case 3:
+                    m_pInstance->SetData(DATA_ICE_WALL_1, IN_PROGRESS);
+                    if(GameObject* pGate = m_pInstance->instance->GetGameObject(m_pInstance->GetData64(GO_ICE_WALL_1)))
+                    {
+                        pGate->SetGoState(GO_STATE_READY);
+                        m_uiIceWallGUID = pGate->GetGUID();
+                    }
+                    break;
+                case 4:
+                    if(me->GetEntry() == NPC_JAINA_OUTRO)
+                        DoScriptText(SAY_JAINA_WALL_01, me);
+                    if(me->GetEntry() == NPC_SYLVANA_OUTRO)
+                        DoScriptText(SAY_SYLVANA_WALL_01, me);
+                    CastTimer = 1000;
+                    HoldTimer = 30000;
+                    SetEscortPaused(true);
+                    if (Creature *pWallTarget = me->SummonCreature(NPC_ICE_WALL,me->GetPositionX(),me->GetPositionY(),me->GetPositionZ(),me->GetOrientation(),TEMPSUMMON_MANUAL_DESPAWN,720000))
+                    {
+                        m_uipWallTargetGUID = pWallTarget->GetGUID();
+                        pWallTarget->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NON_ATTACKABLE | UNIT_FLAG_NOT_SELECTABLE);
+                        if(me->GetEntry() == NPC_JAINA_OUTRO)
+                            me->CastSpell(me, SPELL_DESTROY_ICE_WALL_01, false);
+                    }
+                    WallCast = true;
+                    break;
+                case 6:
+                    m_pInstance->SetData(DATA_ICE_WALL_2, IN_PROGRESS);
+                    if (Creature* pWallTarget = m_pInstance->instance->GetCreature(m_uipWallTargetGUID))
+                    {
+                        if(pWallTarget->isAlive())
+                        {
+                            pWallTarget->ForcedDespawn();
+                            m_uipWallTargetGUID = 0;
+                        }
+                    }
+                    break;
+                case 8:
+                    if(me->GetEntry() == NPC_JAINA_OUTRO)
+                        DoScriptText(SAY_JAINA_WALL_02, me);
+                    if(me->GetEntry() == NPC_SYLVANA_OUTRO)
+                        DoScriptText(SAY_SYLVANA_WALL_02, me);
+                    CastTimer = 1000;
+                    HoldTimer = 30000;
+                    SetEscortPaused(true);
+                    if (Creature *pWallTarget = me->SummonCreature(NPC_ICE_WALL,me->GetPositionX(),me->GetPositionY(),me->GetPositionZ(),me->GetOrientation(),TEMPSUMMON_MANUAL_DESPAWN,720000))
+                    {
+                        m_uipWallTargetGUID = pWallTarget->GetGUID();
+                        pWallTarget->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NON_ATTACKABLE | UNIT_FLAG_NOT_SELECTABLE);
+                        if(me->GetEntry() == NPC_JAINA_OUTRO)
+                            me->CastSpell(me, SPELL_DESTROY_ICE_WALL_01, false);
+                    }
+                    WallCast = true;
+                    break;
+                case 9:
+                    if(me->GetEntry() == NPC_JAINA_OUTRO)
+                        DoScriptText(SAY_JAINA_ESCAPE_01, me);
+                    if(me->GetEntry() == NPC_SYLVANA_OUTRO)
+                        DoScriptText(SAY_SYLVANA_ESCAPE_01, me);
+                    break;
+                case 11:
+                    m_pInstance->SetData(DATA_ICE_WALL_3, IN_PROGRESS);
+                    if (Creature* pWallTarget = m_pInstance->instance->GetCreature(m_uipWallTargetGUID))
+                    {
+                        if(pWallTarget->isAlive())
+                        {
+                            pWallTarget->ForcedDespawn();
+                            m_uipWallTargetGUID = 0;
+                        }
+                    }
+                    break;
+                case 12:
+                    if(me->GetEntry() == NPC_JAINA_OUTRO)
+                        DoScriptText(SAY_JAINA_WALL_03, me);
+                    if(me->GetEntry() == NPC_SYLVANA_OUTRO)
+                        DoScriptText(SAY_SYLVANA_WALL_03, me);
+                    CastTimer = 1000;
+                    HoldTimer = 30000;
+                    SetEscortPaused(true);
+                    if (Creature *pWallTarget = me->SummonCreature(NPC_ICE_WALL,me->GetPositionX(),me->GetPositionY(),me->GetPositionZ(),me->GetOrientation(),TEMPSUMMON_MANUAL_DESPAWN,720000))
+                    {
+                        m_uipWallTargetGUID = pWallTarget->GetGUID();
+                        pWallTarget->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NON_ATTACKABLE | UNIT_FLAG_NOT_SELECTABLE);
+                        if(me->GetEntry() == NPC_JAINA_OUTRO)
+                            me->CastSpell(me, SPELL_DESTROY_ICE_WALL_01, false);
+                    }
+                    WallCast = true;
+                    break;
+                case 13:
+                    if(me->GetEntry() == NPC_JAINA_OUTRO)
+                        DoScriptText(SAY_JAINA_ESCAPE_02, me);
+                    if(me->GetEntry() == NPC_SYLVANA_OUTRO)
+                        DoScriptText(SAY_SYLVANA_ESCAPE_02, me);
+                    break;
+                case 15:
+                    m_pInstance->SetData(DATA_ICE_WALL_4, IN_PROGRESS);
+                    if (Creature* pWallTarget = m_pInstance->instance->GetCreature(m_uipWallTargetGUID))
+                    {
+                        if(pWallTarget->isAlive())
+                        {
+                            pWallTarget->ForcedDespawn();
+                            m_uipWallTargetGUID = 0;
+                        }
+                    }
+                    break;
+                case 16:
+                    if(me->GetEntry() == NPC_JAINA_OUTRO)
+                        DoScriptText(SAY_JAINA_WALL_04, me);
+                    if(me->GetEntry() == NPC_SYLVANA_OUTRO)
+                        DoScriptText(SAY_SYLVANA_WALL_04, me);
+                    CastTimer = 1000;
+                    HoldTimer = 30000;
+                    SetEscortPaused(true);
+                    if (Creature *pWallTarget = me->SummonCreature(NPC_ICE_WALL,me->GetPositionX(),me->GetPositionY(),me->GetPositionZ(),me->GetOrientation(),TEMPSUMMON_MANUAL_DESPAWN,720000))
+                    {
+                        m_uipWallTargetGUID = pWallTarget->GetGUID();
+                        pWallTarget->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NON_ATTACKABLE | UNIT_FLAG_NOT_SELECTABLE);
+                        if(me->GetEntry() == NPC_JAINA_OUTRO)
+                            me->CastSpell(me, SPELL_DESTROY_ICE_WALL_01, false);
+                    }
+                    WallCast = true;
+                    break;
+                case 19:
+                    if(me->GetEntry() == NPC_JAINA_OUTRO)
+                        DoScriptText(SAY_JAINA_TRAP, me);
+                    if(me->GetEntry() == NPC_SYLVANA_OUTRO)
+                        DoScriptText(SAY_SYLVANA_TRAP, me);
+                    break;
+                case 20:
+                    if (Creature* pWallTarget = m_pInstance->instance->GetCreature(m_uipWallTargetGUID))
+                    {
+                        if(pWallTarget->isAlive())
+                        {
+                            pWallTarget->ForcedDespawn();
+                            m_uipWallTargetGUID = 0;
+                        }
+                    }
+                    SetEscortPaused(true);
+                    if(me->GetEntry() == NPC_JAINA_OUTRO)
+                        me->SetUInt32Value(UNIT_NPC_EMOTESTATE, EMOTE_STATE_READY2HL);
+                    if(me->GetEntry() == NPC_SYLVANA_OUTRO)
+                        me->SetUInt32Value(UNIT_NPC_EMOTESTATE, EMOTE_STATE_READY1H);
+                    break;
+            }
+        }
+
+        void MoveInLineOfSight(Unit* who)
+        {
+            if(!who || !m_pInstance)
+                return;
+
+            if(who->GetTypeId() != TYPEID_PLAYER)
+                return;
+
+            Player* player = (Player *)who;
+
+            if(player->GetTeam() == ALLIANCE && me->GetEntry() == NPC_SYLVANA_OUTRO)
+                return;
+
+            if(player->GetTeam() == HORDE && me->GetEntry() == NPC_JAINA_OUTRO)
+                return;
+
+            if(me->IsWithinDistInMap(who, 50.0f)
+                && m_pInstance->GetData(DATA_FROSWORN_EVENT) == DONE
+                && m_pInstance->GetData(DATA_PHASE) == 3)
+            {
+                player = (Player *)who;
+                Event = true;
+                me->setFaction(FACTION);
+                m_pInstance->SetData(DATA_PHASE, 4);
+            }
+        }
+
+        void DamageTaken(Unit* pDoneBy, uint32 &uiDamage)
+        {
+            if(!m_pInstance)
+                return;
+
+            if(m_pInstance->GetData(DATA_LICHKING_EVENT) != IN_PROGRESS)
+            {
+                uiDamage = 0;
+                return;
+            }
+
+            if(m_pInstance->GetData(DATA_LICHKING_EVENT) == IN_PROGRESS && WallCast == true)
+            {
+                HoldTimer = HoldTimer + 100;
+                return;
+            }
+        }
+
+        void JumpNextStep(uint32 Time)
+        {
+            StepTimer = Time;
+            Step++;
+        }
+
+        void Intro()
+        {
+            switch(Step)
+            {
+                case 0:
+                    me->RemoveUnitMovementFlag(MOVEMENTFLAG_WALKING);
+                    m_uiLichKingGUID = m_pInstance->GetData64(DATA_LICHKING);
+                    pLichKing = m_pInstance->instance->GetCreature(m_uiLichKingGUID);
+                    me->SetUInt64Value(UNIT_FIELD_TARGET, pLichKing->GetGUID());
+                    JumpNextStep(100);
+                    break;
+                case 1:
+                    HoRQuestComplete(me->GetEntry());
+                    if(pLichKing)
+                    {
+                        if(me->GetEntry() == NPC_JAINA_OUTRO)
+                            DoScriptText(SAY_LICH_KING_AGGRO_A, pLichKing);
+                        if(me->GetEntry() == NPC_SYLVANA_OUTRO)
+                            DoScriptText(SAY_LICH_KING_AGGRO_H, pLichKing);
+                        pLichKing->AI()->AttackStart(me);
+                        me->AI()->AttackStart(pLichKing);
+                    }
+                    JumpNextStep(3000);
+                    break;
+                case 2:
+                    if(me->GetEntry() == NPC_SYLVANA_OUTRO)
+                    {
+                        Fight = false;
+                        if(pLichKing)
+                            me->GetMotionMaster()->MovePoint(0, (me->GetPositionX()-5)+rand()%10, (me->GetPositionY()-5)+rand()%10, me->GetPositionZ());
+                        JumpNextStep(3000);
+                    }
+                    else
+                        JumpNextStep(100);
+                    break;
+                case 3:
+                    if(me->GetEntry() == NPC_SYLVANA_OUTRO)
+                        Fight = true;
+                    JumpNextStep(100);
+                    break;
+                case 4:
+                    if(me->GetEntry() == NPC_SYLVANA_OUTRO)
+                    {
+                        if(pLichKing)
+                            me->CastSpell(pLichKing, SPELL_SYLVANA_STEP, false);
+                        JumpNextStep(3000);
+                    }
+                    else
+                        JumpNextStep(100);
+                    break;
+                case 5:
+                    if(me->GetEntry() == NPC_SYLVANA_OUTRO)
+                    {
+                        Fight = false;
+                        if(pLichKing)
+                            me->GetMotionMaster()->MovePoint(0, (me->GetPositionX()-5)+rand()%10, (me->GetPositionY()-5)+rand()%10, me->GetPositionZ());
+                        JumpNextStep(3000);
+                    }
+                    else
+                        JumpNextStep(12000);
+                    break;
+                case 6:
+                    Fight = true;
+
+                    if(pLichKing)
+                    {
+                        if(me->GetEntry() == NPC_SYLVANA_OUTRO)
+                            DoCast(SPELL_SYLVANA_JUMP);
+                        DoCast(pLichKing, me->GetEntry() == NPC_JAINA_OUTRO ? SPELL_ICE_PRISON_VISUAL : SPELL_DARK_ARROW, false);
+                        pLichKing->AttackStop();
+                    }
+                    JumpNextStep(1480);
+                    break;
+                case 7:
+                    me->RemoveAllAuras();
+
+                    if(pLichKing && !pLichKing->HasAura(SPELL_ICE_PRISON_VISUAL))
+                        pLichKing->AddAura(me->GetEntry() == NPC_JAINA_OUTRO ? SPELL_ICE_PRISON_VISUAL : SPELL_DARK_ARROW, pLichKing);
+
+                    me->SetUInt32Value(UNIT_NPC_EMOTESTATE, EMOTE_STATE_STAND);
+                    me->AttackStop();
+
+                    if(me->GetEntry() == NPC_JAINA_OUTRO)
+                    {
+                        me->RemoveAurasDueToSpell(SPELL_ICE_BARRIER);
+                        DoScriptText(SAY_JAINA_AGGRO, me);
+                    }
+
+                    if(me->GetEntry() == NPC_SYLVANA_OUTRO)
+                        DoScriptText(SAY_SYLVANA_AGGRO, me);
+
+                    JumpNextStep(3000);
+                    break;
+                case 8:
+                    me->GetMotionMaster()->MovePoint(0, 5577.187f, 2236.003f, 733.012f);
+                    if(pLichKing && !pLichKing->HasAura(SPELL_ICE_PRISON_VISUAL))
+                    {
+                        pLichKing->AddAura(me->GetEntry() == NPC_JAINA_OUTRO ? SPELL_ICE_PRISON_VISUAL : SPELL_DARK_ARROW, pLichKing);
+                        me->SetUInt64Value(UNIT_FIELD_TARGET, pLichKing->GetGUID());
+                    }
+                    JumpNextStep(10000);
+                    break;
+                case 9:
+                    if(pLichKing && (!pLichKing->HasAura(SPELL_ICE_PRISON_VISUAL) || !pLichKing->HasAura(SPELL_DARK_ARROW)))
+                    {
+                        pLichKing->AddAura(me->GetEntry() == NPC_JAINA_OUTRO ? SPELL_ICE_PRISON_VISUAL : SPELL_DARK_ARROW, pLichKing);
+                        me->SetUInt64Value(UNIT_FIELD_TARGET, pLichKing->GetGUID());
+                    }
+                    me->RemoveAllAuras();
+                    me->SetFlag(UNIT_NPC_FLAGS, UNIT_NPC_FLAG_GOSSIP);
+                    Count = 1;
+                    JumpNextStep(100);
+                    break;
+            }
+        }
+
+        void Outro()
+        {
+            switch(Step)
+            {
+                case 10:
+                    JumpNextStep(10000);
+                    break;
+                case 11:
+                    if(GameObject* pGunship = m_pInstance->instance->GetGameObject(m_pInstance->GetData64(me->GetEntry() == NPC_JAINA_OUTRO ? GO_SKYBREAKER : GO_ORGRIM_HAMMER)))
+                        pGunship->SetPhaseMask(1, true);
+
+                    if(Creature* pCaptain = me->SummonCreature(me->GetEntry() == NPC_JAINA_OUTRO? NPC_BARTLETT : NPC_KORM, 5251.17f, 1610.2f, 795.812f, 2.07997f))
+                    {
+                        DoScriptText(me->GetEntry() == NPC_JAINA_OUTRO ? SAY_JAINA_FIRE : SAY_SYLVANA_FIRE, pCaptain);
+                        uiCaptain = pCaptain->GetGUID();
+                    }
+                    if(GameObject* pCave = m_pInstance->instance->GetGameObject(m_pInstance->GetData64(GO_CAVE)))
+                    {
+                        Creature *pCaveTarget = me->SummonCreature(NPC_ICE_WALL,pCave->GetPositionX(),me->GetPositionY(),me->GetPositionZ(),me->GetOrientation(),TEMPSUMMON_MANUAL_DESPAWN,720000);
+                        pCaveTarget->SetFloatValue(OBJECT_FIELD_SCALE_X, 4);
+
+                        for(int8 i = 0; i<4; i++)
+                        {
+                            if(Creature* pCannoner = me->SummonCreature(NPC_ICE_WALL, CannonSpawns[i],TEMPSUMMON_MANUAL_DESPAWN,720000))
+                            {
+                                pCannoner->setFaction(me->getFaction());
+                                pCannoner->CastSpell(pCaveTarget, SPELL_FIRE_CANNON, true);
+                            }
+
+                        }
+                    }
+                    JumpNextStep(6000);
+                    break;
+                case 12:
+                    if(GameObject* pCave = m_pInstance->instance->GetGameObject(m_pInstance->GetData64(GO_CAVE)))
+                        pCave->SetGoState(GO_STATE_READY);
+                    me->RemoveAllAuras();
+
+                    if (pLichKing)
+                        pLichKing->DespawnOrUnsummon();
+
+                    HoRQuestComplete(38211);
+                    JumpNextStep(10000);
+                    break;
+                case 13:
+                    me->SetUInt32Value(UNIT_NPC_EMOTESTATE, EMOTE_STATE_STAND);
+                    m_pInstance->SetData(DATA_LICHKING_EVENT, DONE);
+                    if(Creature* pCaptain = me->GetCreature(*me, uiCaptain))
+                        DoScriptText(me->GetEntry() == NPC_JAINA_OUTRO ? SAY_JAINA_FINAL_1 : SAY_SYLVANA_FINAL_1, pCaptain);
+                    me->SummonGameObject(me->GetEntry() == NPC_JAINA_OUTRO ? GO_STAIRS_SKYBREAKER : GO_STAIRS_ORGRIM_HAMMER, 5247.45f, 1627.72f, 784.302f, 5.88208f, 0, 0, 0.199211f, -0.979957f, 1*DAY);
+                    JumpNextStep(10000);
+                    break;
+                case 14:
+                    DoScriptText(me->GetEntry() == NPC_JAINA_OUTRO ? SAY_JAINA_FINAL_2 : SAY_SYLVANA_FINAL_2, me);
+                    JumpNextStep(20000);
+                    break;
+                case 15:
+                    DoScriptText(me->GetEntry() == NPC_JAINA_OUTRO ? SAY_JAINA_FINAL_3 : 0, me);
+                    JumpNextStep(5000);
+                    break;
+                case 16:
+                    me->SetOrientation(0.68f);
+                    me->SetFlag(UNIT_NPC_FLAGS, UNIT_NPC_FLAG_QUESTGIVER);
+                    me->SetFlag(UNIT_NPC_FLAGS, UNIT_NPC_FLAG_GOSSIP);
+                    JumpNextStep(5000);
+                    break;
+            }
+        }
+
+        void HoRQuestComplete(uint32 killCredit)
+        {
+            if(m_pInstance)
+            {
+                Map::PlayerList const &PlayerList = m_pInstance->instance->GetPlayers();
+                for (Map::PlayerList::const_iterator i = PlayerList.begin(); i != PlayerList.end(); ++i)
+                    i->getSource()->KilledMonsterCredit(killCredit, 0);
+            }
+        }
+
+        void UpdateEscortAI(const uint32 diff)
+        {
+            if(!m_pInstance || !Event)
+                return;
+
+            DoMeleeAttackIfReady();
+
+            if(m_pInstance->GetData(DATA_PHASE) == 4 && m_pInstance->GetData(DATA_LICHKING_EVENT) != IN_PROGRESS)
+            {
+                if(StepTimer < diff)
+                    Intro();
+                else
+                    StepTimer -= diff;
+            }
+
+            if(m_pInstance->GetData(DATA_LICHKING_EVENT) == SPECIAL
+                && m_pInstance->GetData(DATA_PHASE) != 6)       //End Cinematic
+            {
+                m_pInstance->SetData(DATA_PHASE, 6);
+                Step = 10;
+            }
+
+            if (m_pInstance->GetData(DATA_PHASE) == 6)
+            {
+                if(StepTimer < diff)
+                    Outro();
+                else
+                    StepTimer -= diff;
+                return;
+            }
+
+            if(WallCast == true && CastTimer < diff)
+            {
+                if(me->GetEntry() == NPC_SYLVANA_OUTRO)
+                {
+                   if (Creature* pWallTarget = m_pInstance->instance->GetCreature(m_uipWallTargetGUID))
+                        me->CastSpell(pWallTarget, SPELL_DESTROY_ICE_WALL_03, false);
+                    CastTimer = 1000;
+                }
+            }
+            else
+                CastTimer -= diff;
+
+            if (WallCast == true && HoldTimer < 10000 && ( m_pInstance->GetData(DATA_SUMMONS) == 0 || !me->isInCombat()))
+            {
+                WallCast = false;
+                me->InterruptNonMeleeSpells(false);
+                SetEscortPaused(false);
+                if(GameObject* pGate = m_pInstance->instance->GetGameObject(m_uiIceWallGUID))
+                    pGate->SetGoState(GO_STATE_ACTIVE);
+                ++Count;
+                switch(Count)
+                {
+                    case 2:
+                        if(GameObject* pGate = m_pInstance->instance->GetGameObject(m_pInstance->GetData64(GO_ICE_WALL_2)))
+                        {
+                            pGate->SetGoState(GO_STATE_READY);
+                            if(pLichKing && pLichKing->isAlive())
+                                DoScriptText(SAY_LICH_KING_WALL_02, pLichKing);
+                            m_uiIceWallGUID = pGate->GetGUID();
+                        }
+                        break;
+                    case 3:
+                        if(GameObject* pGate = m_pInstance->instance->GetGameObject(m_pInstance->GetData64(GO_ICE_WALL_3)))
+                        {
+                            pGate->SetGoState(GO_STATE_READY);
+                            if(pLichKing && pLichKing->isAlive())
+                                DoScriptText(SAY_LICH_KING_WALL_03, pLichKing);
+                            m_uiIceWallGUID = pGate->GetGUID();
+                        }
+                        break;
+                    case 4:
+                        if(GameObject* pGate = m_pInstance->instance->GetGameObject(m_pInstance->GetData64(GO_ICE_WALL_4)))
+                        {
+                            pGate->SetGoState(GO_STATE_READY);
+                            if(pLichKing && pLichKing->isAlive())
+                                DoScriptText(SAY_LICH_KING_WALL_04, pLichKing);
+                            m_uiIceWallGUID = pGate->GetGUID();
+                        }
+                        break;
+                    case 5:
+                        if(pLichKing && pLichKing->isAlive())
+                        {
+                            pLichKing->RemoveAurasDueToSpell(SPELL_WINTER);
+                            pLichKing->SetSpeed(MOVE_WALK, 2.5f, true);
+                            Step = 0;
+                        }
+                        break;
+                }
+            }
+            else
+            {
+                HoldTimer -= diff;
+                if (HoldTimer <= 0)
+                    HoldTimer = 0;
+            }
+
+            return;
+        }
+    };
+};
+
+class at_hor_waves_restarter : public AreaTriggerScript
+{
+    public:
+        at_hor_waves_restarter() : AreaTriggerScript("at_hor_waves_restarter") {}
+
+        bool OnTrigger(Player* player, AreaTriggerEntry const* /*trigger*/)
+        {
+            InstanceScript* instance = player->GetInstanceScript();
+
+            if (player->isGameMaster())
+                return true;
+
+            if(instance->GetData(DATA_WAVE_COUNT) == SPECIAL)
+                return true;
+
+            if (instance->GetData(DATA_INTRO_EVENT) == DONE && instance->GetData(DATA_MARWYN_EVENT) != DONE)
+            {
+                instance->SetData(DATA_WAVE_COUNT, SPECIAL);
+
+                if (Creature* pFalric = player->GetCreature(*player, instance->GetData64(DATA_FALRIC)))
+                {
+                    pFalric->CastSpell(pFalric, SPELL_BOSS_SPAWN_AURA, true);
+                    pFalric->SetVisible(true);
+                }
+                if (Creature* pMarwyn = player->GetCreature(*player, instance->GetData64(DATA_MARWYN)))
+                {
+                    pMarwyn->CastSpell(pMarwyn, SPELL_BOSS_SPAWN_AURA, true);
+                    pMarwyn->SetVisible(true);
+                }
+            }
+            return true;
+        }
+};
+
+class npc_queldelar : public CreatureScript
+{
+public:
+    npc_queldelar() : CreatureScript("npc_queldelar") { }
+
+    CreatureAI* GetAI(Creature* creature) const
+    {
+        return new npc_queldelarAI(creature);
+    }
+    struct npc_queldelarAI  : public ScriptedAI
+    {
+        npc_queldelarAI(Creature *c) : ScriptedAI(c)
+        {
+        }
+        void MoveInLineOfSight(Unit* who)
+        {
+            if (!who)
+                return;
+            if (me->IsWithinDistInMap(who, 20) && who->HasAura(SPELL_QUELDELAR_AURA))
+            {
+                me->SummonCreature(NPC_QUELDELAR, me->GetPositionX(), me->GetPositionY(), me->GetPositionZ(), me->GetOrientation(), TEMPSUMMON_TIMED_DESPAWN_OUT_OF_COMBAT, 60000);
+                me->DisappearAndDie();
+            }
+        }
+    };
+};
+
 void AddSC_halls_of_reflection()
 {
     new npc_jaina_or_sylvanas_hor(true, "npc_sylvanas_hor_part1");
     new npc_jaina_or_sylvanas_hor(false, "npc_jaina_hor_part1");
+    new npc_jaina_and_sylvana_hor_part2();
     new npc_ghostly_priest();
     new npc_phantom_mage();
     new npc_phantom_hallucination();
     new npc_shadowy_mercenary();
     new npc_spectral_footman();
     new npc_tortured_rifleman();
+    new at_hor_waves_restarter();
+    new npc_frostworn_general();
+    new npc_spiritual_reflection();
+    new npc_queldelar();
 }
diff --git a/src/server/scripts/Northrend/FrozenHalls/HallsOfReflection/halls_of_reflection.h b/src/server/scripts/Northrend/FrozenHalls/HallsOfReflection/halls_of_reflection.h
index 1557fd1..f54128c 100644
--- a/src/server/scripts/Northrend/FrozenHalls/HallsOfReflection/halls_of_reflection.h
+++ b/src/server/scripts/Northrend/FrozenHalls/HallsOfReflection/halls_of_reflection.h
@@ -20,47 +20,108 @@
 
 enum Data
 {
-    DATA_FALRIC_EVENT,
-    DATA_MARWYN_EVENT,
-    DATA_LICHKING_EVENT,
-    DATA_WAVE_COUNT,
-    DATA_TEAM_IN_INSTANCE,
+    MAX_ENCOUNTER          = 4,
+
+    DATA_FALRIC_EVENT      = 1,
+    DATA_MARWYN_EVENT      = 2,
+    DATA_FROSWORN_EVENT    = 3,
+    DATA_LICHKING_EVENT    = 4,
+
+    DATA_INTRO_EVENT       = 5,
+    DATA_TEAM_IN_INSTANCE  = 6,
+    DATA_WAVE_COUNT        = 7,
+
+    DATA_SUMMONS           = 8,
+    DATA_ICE_WALL_1        = 9,
+    DATA_ICE_WALL_2        = 10,
+    DATA_ICE_WALL_3        = 11,
+    DATA_ICE_WALL_4        = 12,
+
+    DATA_PHASE             = 13,
 };
 
 enum Data64
 {
-    DATA_FALRIC,
-    DATA_MARWYN,
-    DATA_LICHKING,
-    DATA_FROSTMOURNE,
+    DATA_FALRIC            = 101,
+    DATA_MARWYN            = 102,
+    DATA_LICHKING          = 103,
+    DATA_ESCAPE_LIDER      = 104,
+    DATA_FROSTMOURNE       = 105,
+    DATA_FRONT_DOOR        = 106,
+    DATA_FROSTWORN_DOOR    = 107,
+    DATA_ARTHAS_DOOR       = 108,
 };
 
 enum Creatures
 {
     NPC_FALRIC                                    = 38112,
     NPC_MARWYN                                    = 38113,
-    NPC_LICH_KING_EVENT                           = 37226,
-    NPC_LICH_KING_BOSS                            = 36954,
+    NPC_FROSTWORN_GENERAL                         = 36723,
+    NPC_REFLECTION                                = 37107,
+    NPC_LICH_KING_EVENT                           = 36954,
+    NPC_QUELDELAR                                 = 37158,
+    BOSS_LICH_KING                                = 37226,
 
     NPC_UTHER                                     = 37225,
     NPC_JAINA_PART1                               = 37221,
-    NPC_JAINA_PART2                               = 36955,
+    NPC_JAINA_OUTRO                               = 36955,
     NPC_SYLVANAS_PART1                            = 37223,
-    NPC_SYLVANAS_PART2                            = 37554,
+    NPC_SYLVANA_OUTRO                             = 37554,
+    NPC_BARTLETT                                  = 37182,
+    NPC_KORM                                      = 37833,
 
     NPC_WAVE_MERCENARY                            = 38177,
     NPC_WAVE_FOOTMAN                              = 38173,
     NPC_WAVE_RIFLEMAN                             = 38176,
     NPC_WAVE_PRIEST                               = 38175,
     NPC_WAVE_MAGE                                 = 38172,
+    NPC_WAVE_LOOT_DUMMY                           = 37906,
+
+    NPC_ICE_WALL                                  = 37014,
+    NPC_RAGING_GNOUL                              = 36940,
+    NPC_RISEN_WITCH_DOCTOR                        = 36941,
+    NPC_ABON                                      = 37069,
+
 };
 
 enum GameObjects
 {
-    GO_FROSTMOURNE                                = 202302,
-    GO_FROSTMOURNE_ALTAR                          = 202236,
-    GO_FRONT_DOOR                                 = 201976,
-    GO_ARTHAS_DOOR                                = 197341,
+    GO_FROSTMOURNE               = 202302,
+    GO_FROSTMOURNE_ALTAR         = 202236,
+    GO_FRONT_DOOR                = 201976,
+    GO_FROSTWORN_DOOR            = 197341,
+    GO_ARTHAS_DOOR               = 197342,
+    GO_RUN_DOOR                  = 197343,
+
+    GO_ICE_WALL_1                = 201385,
+    GO_ICE_WALL_2                = 201885,
+    GO_ICE_WALL_3                = 202396,
+    GO_ICE_WALL_4                = 500001,
+    GO_CAVE                      = 201596,
+
+    GO_STAIRS_SKYBREAKER         = 201709,
+    GO_SKYBREAKER                = 500002,
+    GO_STAIRS_ORGRIM_HAMMER      = 202211,
+    GO_ORGRIM_HAMMER             = 500003,
+    GO_PORTAL                    = 202079,
+    GO_CAPTAIN_CHEST_1           = 202212, //3145
+    GO_CAPTAIN_CHEST_2           = 201710, //30357
+    GO_CAPTAIN_CHEST_3           = 202337, //3246
+    GO_CAPTAIN_CHEST_4           = 202336, //3333
+};
+
+enum Achievements
+{
+    ACHIEV_HALLS_OF_REFLECTION_N   = 4518,
+    ACHIEV_HALLS_OF_REFLECTION_H   = 4521,
+    ACHIEV_NOT_RETREATING_EVENT    = 22615,
+    SPELL_ACHIEV_CHECK             = 72830,
+};
+
+const Position OutroSpawns[2] =
+{
+    {5564.25f, 2274.69f, 733.01f, 3.93f}, // Lich King
+    {5556.27f, 2266.28f, 733.01f, 0.8f},  // Jaina/Sylvana
 };
 
 enum HorWorldStates
diff --git a/src/server/scripts/Northrend/FrozenHalls/HallsOfReflection/instance_halls_of_reflection.cpp b/src/server/scripts/Northrend/FrozenHalls/HallsOfReflection/instance_halls_of_reflection.cpp
index 3c4d058..359244f 100644
--- a/src/server/scripts/Northrend/FrozenHalls/HallsOfReflection/instance_halls_of_reflection.cpp
+++ b/src/server/scripts/Northrend/FrozenHalls/HallsOfReflection/instance_halls_of_reflection.cpp
@@ -18,12 +18,11 @@
 #include "ScriptPCH.h"
 #include "halls_of_reflection.h"
 
-#define MAX_ENCOUNTER 3
-
 /* Halls of Reflection encounters:
 0- Falric
 1- Marwyn
-2- The Lich King
+2- Frostworn General
+3- The Lich King
 */
 
 enum eEnum
@@ -112,19 +111,30 @@ public:
 
         uint64 uiFalric;
         uint64 uiMarwyn;
-        uint64 uiLichKingEvent;
+        uint64 uiLichKing;
         uint64 uiJainaPart1;
         uint64 uiSylvanasPart1;
+        uint64 uiLider;
+
+        uint64 uiGunship;
+        uint64 uiChest;
+        uint64 uiPortal;
 
         uint64 uiFrostmourne;
-        uint64 uiFrostmourneAltar;
-        uint64 uiArthasDoor;
         uint64 uiFrontDoor;
+        uint64 uiFrostwornDoor;
+        uint64 uiArthasDoor;
+        uint64 uiRunDoor;
+        uint64 uiWall[4];
+        uint64 uiWallID[4];
+        uint64 uiCaveDoor;
 
         uint32 uiEncounter[MAX_ENCOUNTER];
         uint32 uiTeamInInstance;
         uint32 uiWaveCount;
-        bool bIntroDone;
+        uint32 uiIntroDone;
+        uint32 uiSummons;
+        uint32 uiDataPhase;
 
         EventMap events;
 
@@ -134,22 +144,48 @@ public:
 
             uiFalric = 0;
             uiMarwyn = 0;
-            uiLichKingEvent = 0;
+            uiLichKing = 0;
             uiJainaPart1 = 0;
             uiSylvanasPart1 = 0;
+            uiLider = 0;
+
+            uiGunship = 0;
+            uiChest = 0;
+            uiPortal = 0;
 
             uiFrostmourne = 0;
-            uiFrostmourneAltar = 0;
             uiArthasDoor = 0;
+            uiFrostwornDoor = 0;
             uiFrontDoor = 0;
+            uiCaveDoor = 0;
             uiTeamInInstance = 0;
             uiWaveCount = 0;
-            bIntroDone = false;
+            uiIntroDone = 0;
+
+            for (uint8 i = 0; i < 4; ++i)
+            {
+                uiWall[i] = 0;
+                uiWallID[i] = 0;
+            }
 
             for (uint8 i = 0; i < MAX_ENCOUNTER; ++i)
                 uiEncounter[i] = NOT_STARTED;
         }
 
+        void OpenDoor(uint64 guid)
+        {
+            if(!guid) return;
+            GameObject* go = instance->GetGameObject(guid);
+            if(go) go->SetGoState(GO_STATE_ACTIVE);
+        }
+
+        void CloseDoor(uint64 guid)
+        {
+            if(!guid) return;
+            GameObject* go = instance->GetGameObject(guid);
+            if(go) go->SetGoState(GO_STATE_READY);
+        }
+
         void OnCreatureCreate(Creature* creature)
         {
             Map::PlayerList const &players = instance->GetPlayers();
@@ -166,14 +202,29 @@ public:
                     uiMarwyn = creature->GetGUID();
                     break;
                 case NPC_LICH_KING_EVENT:
-                    uiLichKingEvent = creature->GetGUID();
                     break;
                 case NPC_JAINA_PART1:
+                    if (uiTeamInInstance == HORDE)
+                        creature->UpdateEntry(NPC_SYLVANAS_PART1, HORDE);
                     uiJainaPart1 = creature->GetGUID();
+                    uiSylvanasPart1 = creature->GetGUID();
                     break;
                 case NPC_SYLVANAS_PART1:
                     uiSylvanasPart1 = creature->GetGUID();
                     break;
+                case NPC_FROSTWORN_GENERAL:
+                    creature->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NON_ATTACKABLE);
+                    break;
+                case NPC_JAINA_OUTRO:
+                    if (uiTeamInInstance == HORDE)
+                        creature->UpdateEntry(NPC_SYLVANA_OUTRO, HORDE);
+                    creature->SetHealth(252000);
+                    uiLider = creature->GetGUID();
+                    break;
+                case BOSS_LICH_KING:
+                    creature->SetHealth(20917000);
+                    uiLichKing = creature->GetGUID();
+                    break;
             }
         }
 
@@ -188,23 +239,77 @@ public:
                     HandleGameObject(0, false, go);
                     break;
                 case GO_FROSTMOURNE_ALTAR:
-                    uiFrostmourneAltar = go->GetGUID();
                     go->SetFlag(GAMEOBJECT_FLAGS, GO_FLAG_INTERACT_COND);
                     HandleGameObject(0, true, go);
                     break;
                 case GO_FRONT_DOOR:
                     uiFrontDoor = go->GetGUID();
                     go->SetFlag(GAMEOBJECT_FLAGS, GO_FLAG_INTERACT_COND);
-                    HandleGameObject(0, true, go);
+                    OpenDoor(uiFrontDoor);
                     break;
-                case GO_ARTHAS_DOOR:
-                    uiArthasDoor = go->GetGUID();
+                case GO_FROSTWORN_DOOR:
+                    uiFrostwornDoor = go->GetGUID();
                     go->SetFlag(GAMEOBJECT_FLAGS, GO_FLAG_INTERACT_COND);
 
                     if (uiEncounter[1] == DONE)
-                        HandleGameObject(0, true, go);
+                        OpenDoor(uiFrostwornDoor);
                     else
-                        HandleGameObject(0, false, go);
+                        CloseDoor(uiFrostwornDoor);
+                    break;
+                case GO_RUN_DOOR:
+                    uiRunDoor = go->GetGUID();
+                    break;
+                case GO_ARTHAS_DOOR:
+                    uiArthasDoor = go->GetGUID();
+                    break;
+                case GO_ICE_WALL_1:
+                    uiWallID[0] = go->GetGUID();
+                    break;
+                case GO_ICE_WALL_2:
+                    uiWallID[1] = go->GetGUID();
+                    break;
+                case GO_ICE_WALL_3:
+                    uiWallID[2] = go->GetGUID();
+                    break;
+                case GO_ICE_WALL_4:
+                    uiWallID[3] = go->GetGUID();
+                    break;
+                case GO_CAVE:
+                    uiCaveDoor = go->GetGUID();
+                    break;
+                case GO_CAPTAIN_CHEST_1:
+                    go->SetPhaseMask(2, true);
+                    if (!instance->IsHeroic() && uiTeamInInstance == HORDE)
+                        uiChest = go->GetGUID();
+                    break;
+                case GO_CAPTAIN_CHEST_3:
+                    go->SetPhaseMask(2, true);
+                    if (instance->IsHeroic() && uiTeamInInstance == HORDE)
+                        uiChest = go->GetGUID();
+                    break;
+                case GO_CAPTAIN_CHEST_2:
+                    go->SetPhaseMask(2, true);
+                    if (!instance->IsHeroic() && uiTeamInInstance == ALLIANCE)
+                        uiChest = go->GetGUID();
+                    break;
+                case GO_CAPTAIN_CHEST_4:
+                    go->SetPhaseMask(2, true);
+                    if (instance->IsHeroic() && uiTeamInInstance == ALLIANCE)
+                        uiChest = go->GetGUID();
+                    break;
+                case GO_SKYBREAKER:
+                    go->SetPhaseMask(2, true);
+                    if (uiTeamInInstance == ALLIANCE)
+                        uiGunship = go->GetGUID();
+                    break;
+                case GO_ORGRIM_HAMMER:
+                    go->SetPhaseMask(2, true);
+                    if (uiTeamInInstance == HORDE)
+                        uiGunship = go->GetGUID();
+                    break;
+                case GO_PORTAL:
+                    go->SetPhaseMask(2, true);
+                    uiPortal = go->GetGUID();
                     break;
             }
         }
@@ -213,7 +318,7 @@ public:
         {
             if (type == DATA_WAVE_COUNT && data == SPECIAL)
             {
-                bIntroDone = true;
+                CloseDoor(uiFrontDoor);
                 events.ScheduleEvent(EVENT_NEXT_WAVE, 10000);
                 return;
             }
@@ -223,6 +328,9 @@ public:
 
             switch (type)
             {
+                case DATA_INTRO_EVENT:
+                    uiIntroDone = data;
+                    break;
                 case DATA_FALRIC_EVENT:
                     uiEncounter[0] = data;
                     if (data == DONE)
@@ -231,10 +339,85 @@ public:
                 case DATA_MARWYN_EVENT:
                     uiEncounter[1] = data;
                     if (data == DONE)
-                        HandleGameObject(uiArthasDoor, true);
+                    {
+                        OpenDoor(uiFrostwornDoor);
+                        OpenDoor(uiFrontDoor);
+                    }
                     break;
-                case DATA_LICHKING_EVENT:
+                case DATA_FROSWORN_EVENT:
                     uiEncounter[2] = data;
+                    if (data == DONE)
+                    {
+                        OpenDoor(uiArthasDoor);
+                        SetData(DATA_PHASE, 3);
+                        instance->SummonCreature(BOSS_LICH_KING, OutroSpawns[0]);
+                        instance->SummonCreature(NPC_JAINA_OUTRO, OutroSpawns[1]);
+                    }
+                    break;
+                case DATA_LICHKING_EVENT:
+                    uiEncounter[3] = data;
+                    if(data == IN_PROGRESS)
+                    {
+                        OpenDoor(uiRunDoor);
+
+                        if(instance->IsHeroic())
+                            DoStartTimedAchievement(ACHIEVEMENT_TIMED_TYPE_EVENT, ACHIEV_NOT_RETREATING_EVENT);
+                    }
+                    if(data == FAIL)
+                    {
+                        for(uint8 i = 0; i<4; i++)
+                            OpenDoor(uiWallID[i]);
+
+                        CloseDoor(uiRunDoor);
+
+                        if(Creature* pLichKing = instance->GetCreature(uiLichKing))
+                            pLichKing->DespawnOrUnsummon(10000);
+                        if(Creature* pLider = instance->GetCreature(uiLider))
+                            pLider->DespawnOrUnsummon(10000);
+
+                        DoStopTimedAchievement(ACHIEVEMENT_TIMED_TYPE_EVENT, ACHIEV_NOT_RETREATING_EVENT);
+                        DoCastSpellOnPlayers(5); // Kill all players
+
+                        SetData(DATA_PHASE, 3);
+                        instance->SummonCreature(BOSS_LICH_KING, OutroSpawns[0]);
+                        instance->SummonCreature(NPC_JAINA_OUTRO, OutroSpawns[1]);
+                    }
+                    if(data == DONE)
+                    {
+                        if(GameObject *pChest = instance->GetGameObject(uiChest))
+                            pChest->SetPhaseMask(1, true);
+                        if(GameObject *pPortal = instance->GetGameObject(uiPortal))
+                            pPortal->SetPhaseMask(1, true);
+
+                        DoCompleteAchievement(ACHIEV_HALLS_OF_REFLECTION_N);
+                        if(instance->IsHeroic())
+                        {
+                            DoCompleteAchievement(ACHIEV_HALLS_OF_REFLECTION_H);
+                            DoCastSpellOnPlayers(SPELL_ACHIEV_CHECK);
+                            DoStopTimedAchievement(ACHIEVEMENT_TIMED_TYPE_EVENT, ACHIEV_NOT_RETREATING_EVENT);
+                        }
+                    }
+                    break;
+                case DATA_SUMMONS:
+                    if (data == 3) uiSummons = 0;
+                    else if (data == 1) ++uiSummons;
+                    else if (data == 0) --uiSummons;
+                    data = NOT_STARTED;
+                    break;
+                case DATA_ICE_WALL_1:
+                    uiWall[0] = data;
+                    break;
+                case DATA_ICE_WALL_2:
+                    uiWall[1] = data;
+                    break;
+                case DATA_ICE_WALL_3:
+                    uiWall[2] = data;
+                    break;
+                case DATA_ICE_WALL_4:
+                    uiWall[3] = data;
+                    break;
+                case DATA_PHASE:
+                    uiDataPhase = data;
                     break;
             }
 
@@ -246,11 +429,23 @@ public:
         {
             switch (type)
             {
+                case DATA_INTRO_EVENT:          return uiIntroDone;
+                case DATA_TEAM_IN_INSTANCE:     return uiTeamInInstance;
+
                 case DATA_FALRIC_EVENT:         return uiEncounter[0];
                 case DATA_MARWYN_EVENT:         return uiEncounter[1];
-                case DATA_LICHKING_EVENT:       return uiEncounter[2];
                 case DATA_WAVE_COUNT:           return uiWaveCount;
-                case DATA_TEAM_IN_INSTANCE:     return uiTeamInInstance;
+
+                case DATA_FROSWORN_EVENT:       return uiEncounter[2];
+
+                case DATA_LICHKING_EVENT:       return uiEncounter[3];
+                case DATA_ICE_WALL_1:           return uiWall[0];
+                case DATA_ICE_WALL_2:           return uiWall[1];
+                case DATA_ICE_WALL_3:           return uiWall[2];
+                case DATA_ICE_WALL_4:           return uiWall[3];
+                case DATA_SUMMONS:              return uiSummons;
+
+                case DATA_PHASE:                return uiDataPhase;
             }
 
             return 0;
@@ -262,8 +457,23 @@ public:
             {
                 case DATA_FALRIC:               return uiFalric;
                 case DATA_MARWYN:               return uiMarwyn;
-                case DATA_LICHKING:             return uiLichKingEvent;
+                case DATA_LICHKING:             return uiLichKing;
+                case DATA_ESCAPE_LIDER:         return uiLider;
                 case DATA_FROSTMOURNE:          return uiFrostmourne;
+                case DATA_FRONT_DOOR:           return uiFrontDoor;
+                case DATA_FROSTWORN_DOOR:       return uiFrostwornDoor;
+                case DATA_ARTHAS_DOOR:          return uiArthasDoor;
+                case GO_ICE_WALL_1:             return uiWallID[0];
+                case GO_ICE_WALL_2:             return uiWallID[1];
+                case GO_ICE_WALL_3:             return uiWallID[2];
+                case GO_ICE_WALL_4:             return uiWallID[3];
+                case GO_CAVE:                   return uiCaveDoor;
+                case GO_CAPTAIN_CHEST_1:
+                case GO_CAPTAIN_CHEST_2:
+                case GO_CAPTAIN_CHEST_3:
+                case GO_CAPTAIN_CHEST_4:        return uiChest;
+                case GO_SKYBREAKER:
+                case GO_ORGRIM_HAMMER:            return uiGunship;
             }
 
             return 0;
@@ -274,7 +484,7 @@ public:
             OUT_SAVE_INST_DATA;
 
             std::ostringstream saveStream;
-            saveStream << "H R 1 " << uiEncounter[0] << ' ' << uiEncounter[1] << ' ' << uiEncounter[2];
+            saveStream << "H R 1 " << uiEncounter[0] << " " << uiEncounter[1] << " " << uiEncounter[2] << " " << uiEncounter[3] << " " << uiIntroDone;
 
             OUT_SAVE_INST_DATA_COMPLETE;
             return saveStream.str();
@@ -292,25 +502,30 @@ public:
 
             char dataHead1, dataHead2;
             uint16 version;
-            uint16 data0, data1, data2;
+            uint16 data0, data1, data2, data3, data4;
 
             std::istringstream loadStream(in);
-            loadStream >> dataHead1 >> dataHead2 >> version >> data0 >> data1 >> data2;
+            loadStream >> dataHead1 >> dataHead2 >> version >> data0 >> data1 >> data2 >> data3 >> data4;
 
             if (dataHead1 == 'H' && dataHead2 == 'R')
             {
                 uiEncounter[0] = data0;
                 uiEncounter[1] = data1;
                 uiEncounter[2] = data2;
+                uiEncounter[3] = data3;
+                uiIntroDone = data4;
 
                 for (uint8 i = 0; i < MAX_ENCOUNTER; ++i)
                     if (uiEncounter[i] == IN_PROGRESS)
                         uiEncounter[i] = NOT_STARTED;
 
-            } else OUT_LOAD_INST_DATA_FAIL;
+                OpenDoor(uiFrontDoor);
+                if (uiEncounter[1] == DONE)
+                    OpenDoor(uiFrostwornDoor);
+                if (uiEncounter[2] == DONE)
+                    OpenDoor(uiArthasDoor);
 
-            if (uiEncounter[0] == DONE || uiEncounter[1] == DONE)
-                bIntroDone = true;
+            } else OUT_LOAD_INST_DATA_FAIL;
 
             OUT_LOAD_INST_DATA_COMPLETE;
         }
@@ -355,24 +570,24 @@ public:
         // Wipe has been detected. Perform cleanup and reset.
         void DoWipe()
         {
-            uiWaveCount = 0;
-            events.Reset();
-            DoUpdateWorldState(WORLD_STATE_HOR, 1);
-            DoUpdateWorldState(WORLD_STATE_HOR_WAVE_COUNT, uiWaveCount);
-            HandleGameObject(uiFrontDoor, true);
+
+            if (GetData(DATA_MARWYN_EVENT) != DONE) {
+
+                SetData(DATA_WAVE_COUNT, FAIL);
+                uiWaveCount = 0;
+                events.Reset();
+                DoUpdateWorldState(WORLD_STATE_HOR, 1);
+                DoUpdateWorldState(WORLD_STATE_HOR_WAVE_COUNT, uiWaveCount);
+                OpenDoor(uiFrontDoor);
 
             // TODO
             // in case of wipe, the event is normally restarted by jumping into the center of the room.
             // As I can't find a trigger area there, just respawn Jaina/Sylvanas so the event may be restarted.
-            if (Creature* pJaina = instance->GetCreature(uiJainaPart1))
-                pJaina->Respawn();
-            if (Creature* pSylvanas = instance->GetCreature(uiSylvanasPart1))
-                pSylvanas->Respawn();
-
             if (Creature* pFalric = instance->GetCreature(uiFalric))
                 pFalric->SetVisible(false);
             if (Creature* pMarwyn = instance->GetCreature(uiMarwyn))
                 pMarwyn->SetVisible(false);
+            }
         }
 
         // spawn a wave on behalf of the summoner.
@@ -413,9 +628,6 @@ public:
                     uiWaveCount++;
                     AddWave();
                     break;
-                case EVENT_START_LICH_KING:
-                    // TODO
-                    break;
             }
         }
     };
-- 
1.7.8.msysgit.0

